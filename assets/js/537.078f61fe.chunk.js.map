{"version":3,"file":"assets/js/537.078f61fe.chunk.js","mappings":"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","sources":["webpack://job-tracker-dashboard/./src/entities/loopMatch/api/loopMatchesApi.ts","webpack://job-tracker-dashboard/./src/entities/loopMatch/ui/matchCard/matchFormat.ts","webpack://job-tracker-dashboard/./src/entities/loopMatch/ui/matchCard/MatchCard.tsx","webpack://job-tracker-dashboard/./src/entities/loopMatch/ui/matchCard/MatchDetailsModal.tsx"],"sourcesContent":["import {\n  addDoc,\n  deleteDoc,\n  getDoc,\n  getDocs,\n  orderBy,\n  query,\n  serverTimestamp,\n  updateDoc,\n  where,\n  type FieldValue,\n  type UpdateData,\n} from \"firebase/firestore\";\n\nimport { userLoopMatchDoc, userLoopMatchesCol } from \"src/shared/api/firestoreRefs\";\nimport { baseApi } from \"src/shared/api/rtk/baseApi\";\nimport { requireUidFromState } from \"src/shared/api/rtk/requireUid\";\n\nimport type {\n  CreateLoopMatchInput,\n  DeleteLoopMatchInput,\n  LoopMatch,\n  UpdateLoopMatchInput,\n  UpdateLoopMatchStatusInput,\n} from \"../model/types\";\n\n\ntype ApiError = { message: string };\n\nfunction toMsg(e: unknown): string {\n  return e instanceof Error ? e.message : String(e);\n}\n\nfunction rtkError(message: string) {\n  return { error: { message } as ApiError } as const;\n}\n\nfunction makeTimestamps(): { iso: string; server: FieldValue } {\n  const iso = new Date().toISOString();\n  return { iso, server: serverTimestamp() };\n}\n\nexport type GetMatchesByLoopArgs = { loopId: string };\nexport type GetMatchArgs = { matchId: string };\n\nfunction normalizeUrl(input: string): string {\n  const v = String(input ?? \"\").trim();\n  if (!v) return \"\";\n  if (!/^https?:\\/\\//i.test(v)) return `https://${v}`;\n  return v;\n}\n\nfunction cleanPatch(patch: UpdateLoopMatchInput[\"patch\"]): UpdateLoopMatchInput[\"patch\"] {\n  const out: UpdateLoopMatchInput[\"patch\"] = { ...patch };\n  if (typeof out.url === \"string\") out.url = normalizeUrl(out.url);\n  return out;\n}\n\nfunction mapLoopMatchDoc(id: string, data: Record<string, unknown>): LoopMatch {\n  // Firestore stores server timestamps as Timestamp objects.\n  // Those are not serializable and must not end up in RTK Query cache.\n  const rest = { ...data };\n  delete (rest as { createdAtTs?: unknown }).createdAtTs;\n  delete (rest as { updatedAtTs?: unknown }).updatedAtTs;\n\n  return {\n    id,\n    ...(rest as Omit<LoopMatch, \"id\">),\n  };\n}\n\nexport const loopMatchesApi = baseApi.injectEndpoints({\n  endpoints: (builder) => ({\n    // --------------------\n    // LIST: all matches\n    // --------------------\n    getAllMatches: builder.query<LoopMatch[], void>({\n      async queryFn(_arg, api) {\n        try {\n          const uid = requireUidFromState(api.getState());\n          const q = query(\n            userLoopMatchesCol(uid),\n            orderBy(\"matchedAt\", \"desc\")\n          );\n\n          const snap = await getDocs(q);\n          const matches: LoopMatch[] = snap.docs.map((d) =>\n            mapLoopMatchDoc(d.id, d.data() as Record<string, unknown>),\n          );\n\n          return { data: matches };\n        } catch (e) {\n          return rtkError(toMsg(e));\n        }\n      },\n      providesTags: (res) =>\n        res\n          ? [\n              ...res.map((m) => ({ type: \"LoopMatches\" as const, id: m.id })),\n              { type: \"LoopMatches\" as const, id: \"LIST:ALL\" },\n            ]\n          : [{ type: \"LoopMatches\" as const, id: \"LIST:ALL\" }],\n    }),\n\n    // --------------------\n    // LIST: matches by loopId\n    // --------------------\n    getMatchesByLoop: builder.query<LoopMatch[], GetMatchesByLoopArgs>({\n      async queryFn({ loopId }, api) {\n        try {\n          const uid = requireUidFromState(api.getState());\n          const q = query(\n            userLoopMatchesCol(uid),\n            // loopId remains a field to filter matches that belong to a loop\n            // (even though ownership is already enforced by path)\n            where(\"loopId\", \"==\", loopId),\n            orderBy(\"matchedAt\", \"desc\")\n          );\n\n          const snap = await getDocs(q);\n          const matches: LoopMatch[] = snap.docs.map((d) =>\n            mapLoopMatchDoc(d.id, d.data() as Record<string, unknown>),\n          );\n\n          return { data: matches };\n        } catch (e) {\n          return rtkError(toMsg(e));\n        }\n      },\n      providesTags: (_res, _err, arg) => [\n        { type: \"LoopMatches\" as const, id: `LIST:LOOP:${arg.loopId}` },\n      ],\n    }),\n\n    // --------------------\n    // GET: one match by id\n    // --------------------\n    getMatch: builder.query<LoopMatch | null, GetMatchArgs>({\n      async queryFn({ matchId }, api) {\n        try {\n          const uid = requireUidFromState(api.getState());\n          const snap = await getDoc(userLoopMatchDoc(uid, matchId));\n          if (!snap.exists()) return { data: null };\n\n          return {\n            data: mapLoopMatchDoc(\n              snap.id,\n              (snap.data() as Record<string, unknown>) ?? {},\n            ),\n          };\n        } catch (e) {\n          return rtkError(toMsg(e));\n        }\n      },\n      providesTags: (_res, _err, arg) => [\n        { type: \"LoopMatches\" as const, id: arg.matchId },\n      ],\n    }),\n\n    // --------------------\n    // CREATE\n    // --------------------\n    createMatch: builder.mutation<{ id: string }, CreateLoopMatchInput>({\n      async queryFn(input, api) {\n        try {\n          const uid = requireUidFromState(api.getState());\n          const { iso, server } = makeTimestamps();\n\n          const payload = {\n            ...input,\n            url: normalizeUrl(input.url),\n            createdAt: iso,\n            updatedAt: iso,\n            createdAtTs: server,\n            updatedAtTs: server,\n          } as Record<string, unknown>;\n\n          const ref = await addDoc(userLoopMatchesCol(uid), payload);\n          return { data: { id: ref.id } };\n        } catch (e) {\n          return rtkError(toMsg(e));\n        }\n      },\n      invalidatesTags: (_r, _e, arg) => [\n        { type: \"LoopMatches\" as const, id: \"LIST:ALL\" },\n        { type: \"LoopMatches\" as const, id: `LIST:LOOP:${arg.loopId}` },\n      ],\n    }),\n\n    // --------------------\n    // UPDATE: status only\n    // --------------------\n    updateMatchStatus: builder.mutation<void, UpdateLoopMatchStatusInput>({\n      async queryFn({ matchId, status }, api) {\n        try {\n          const { iso, server } = makeTimestamps();\n          const uid = requireUidFromState(api.getState());\n\n          await updateDoc(userLoopMatchDoc(uid, matchId), {\n            status,\n            updatedAt: iso,\n            updatedAtTs: server,\n          } as UpdateData<Omit<LoopMatch, \"id\">>);\n\n          return { data: undefined };\n        } catch (e) {\n          return rtkError(toMsg(e));\n        }\n      },\n      invalidatesTags: (_r, _e, arg) => [\n        { type: \"LoopMatches\" as const, id: arg.matchId },\n        { type: \"LoopMatches\" as const, id: \"LIST:ALL\" },\n        { type: \"LoopMatches\" as const, id: `LIST:LOOP:${arg.loopId}` },\n      ],\n    }),\n\n    // --------------------\n    // UPDATE: fields\n    // --------------------\n    updateMatch: builder.mutation<void, UpdateLoopMatchInput>({\n      async queryFn({ matchId, patch }, api) {\n        try {\n          const { iso, server } = makeTimestamps();\n          const cleaned = cleanPatch(patch);\n\n          const uid = requireUidFromState(api.getState());\n\n          await updateDoc(userLoopMatchDoc(uid, matchId), {\n            ...cleaned,\n            updatedAt: iso,\n            updatedAtTs: server,\n          } as UpdateData<Omit<LoopMatch, \"id\">>);\n\n          return { data: undefined };\n        } catch (e) {\n          return rtkError(toMsg(e));\n        }\n      },\n      invalidatesTags: (_r, _e, arg) => [\n        { type: \"LoopMatches\" as const, id: arg.matchId },\n        { type: \"LoopMatches\" as const, id: \"LIST:ALL\" },\n        // We don't know the loopId from patch alone; we invalidate all matches list.\n      ],\n    }),\n\n    // --------------------\n    // DELETE\n    // --------------------\n    deleteMatch: builder.mutation<void, DeleteLoopMatchInput>({\n      async queryFn({ matchId }, api) {\n        try {\n          const uid = requireUidFromState(api.getState());\n          await deleteDoc(userLoopMatchDoc(uid, matchId));\n          return { data: undefined };\n        } catch (e) {\n          return rtkError(toMsg(e));\n        }\n      },\n      invalidatesTags: (_r, _e, arg) => [\n        { type: \"LoopMatches\" as const, id: arg.matchId },\n        { type: \"LoopMatches\" as const, id: \"LIST:ALL\" },\n        { type: \"LoopMatches\" as const, id: `LIST:LOOP:${arg.loopId}` },\n      ],\n    }),\n  }),\n});\n\nexport const {\n  useGetAllMatchesQuery,\n  useGetMatchesByLoopQuery,\n  useGetMatchQuery,\n  useCreateMatchMutation,\n  useUpdateMatchStatusMutation,\n  useUpdateMatchMutation,\n  useDeleteMatchMutation,\n} = loopMatchesApi;\n","import type { LoopPlatform } from \"src/entities/loop/model\";\nimport { PLATFORM_REGISTRY } from \"src/entities/loop/model/platformRegistry\";\n\nconst knownPlatforms = new Set<string>(PLATFORM_REGISTRY.map((p) => p.id));\n\nexport function normalizePlatform(p: unknown): LoopPlatform | \"\" {\n  if (typeof p !== \"string\") return \"\";\n  const v = p.trim().toLowerCase();\n  if (!v) return \"\";\n  if (!knownPlatforms.has(v)) return \"\";\n  return v as LoopPlatform;\n}\n\nexport function formatMatchedAt(iso: string): string {\n  if (!iso) return \"\";\n  const d = new Date(iso);\n  if (Number.isNaN(d.getTime())) return iso;\n\n  const yyyy = String(d.getFullYear());\n  const mm = String(d.getMonth() + 1).padStart(2, \"0\");\n  const dd = String(d.getDate()).padStart(2, \"0\");\n\n  return `${dd}.${mm}.${yyyy}`;\n}\n","import React from \"react\";\nimport { useTranslation } from \"react-i18next\";\n\nimport { classNames } from \"src/shared/lib\";\nimport { Button, Card } from \"src/shared/ui\";\n\nimport type { LoopMatch, LoopMatchStatus } from \"../../model/types\";\n\nimport { formatMatchedAt, normalizePlatform } from \"./matchFormat\";\n\ntype MatchCardProps = {\n  match: LoopMatch;\n  loopName: string;\n  busy: boolean;\n  onUpdateStatus: (matchId: LoopMatch[\"id\"], status: LoopMatchStatus) => void;\n  onDelete: (matchId: LoopMatch[\"id\"]) => void;\n  onEdit?: (matchId: LoopMatch[\"id\"]) => void;\n};\n\nconst STATUS_OPTIONS = [\n  \"new\",\n  \"saved\",\n  \"interview\",\n  \"offer\",\n  \"applied\",\n  \"rejected\",\n] as const satisfies readonly LoopMatchStatus[];\n\nexport function MatchCard({\n  match,\n  loopName,\n  busy,\n  onUpdateStatus,\n  onDelete,\n  onEdit,\n}: MatchCardProps) {\n  const { t } = useTranslation();\n\n  const matchedAt = React.useMemo(\n    () => formatMatchedAt(match.matchedAt),\n    [match.matchedAt],\n  );\n\n  const platform = React.useMemo(() => {\n    const p = normalizePlatform(match.platform);\n    return p ? p.toUpperCase() : \"\";\n  }, [match.platform]);\n\n  const meta = React.useMemo(() => {\n    const parts = [match.location, platform, matchedAt, loopName]\n      .map((v) => String(v ?? \"\").trim())\n      .filter(Boolean);\n    return parts.join(\" • \");\n  }, [match.location, platform, matchedAt, loopName]);\n\n  return (\n    <Card variant=\"default\" padding=\"md\" shadow=\"sm\" className=\"flex flex-col gap-sm\">\n      <div className=\"flex items-start justify-between gap-md\">\n        <div className=\"min-w-0\">\n          <div className=\"min-w-0 whitespace-nowrap overflow-hidden text-ellipsis text-sm\">\n            <span className=\"font-semibold text-foreground\">{match.title || \"—\"}</span>\n            <span className=\"ml-2 text-muted-foreground\">{match.company || \"—\"}</span>\n          </div>\n\n          {meta ? (\n            <div className=\"mt-1 text-xs text-muted-foreground whitespace-nowrap overflow-hidden text-ellipsis\">\n              {meta}\n            </div>\n          ) : null}\n        </div>\n\n        <div className=\"flex items-center gap-sm\">\n          <StatusPill value={match.status} />\n        </div>\n      </div>\n\n      <div className=\"flex flex-wrap items-center justify-between gap-sm pt-xs\">\n        <label className=\"flex items-center gap-sm text-sm\">\n          <span className=\"text-muted-foreground\">{t(\"matches.common.status\")}</span>\n          <select\n            value={match.status}\n            disabled={busy}\n            onChange={(e) => onUpdateStatus(match.id, e.target.value as LoopMatchStatus)}\n            className={classNames(\n              \"h-9 rounded-full px-sm\",\n              \"border border-border bg-card text-foreground\",\n              \"focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background\",\n            )}\n          >\n            {STATUS_OPTIONS.map((s) => (\n              <option key={s} value={s}>\n                {t(`matches.status.${s}`)}\n              </option>\n            ))}\n          </select>\n        </label>\n\n        <div className=\"flex items-center gap-sm\">\n          {onEdit ? (\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              shape=\"pill\"\n              disabled={busy}\n              onClick={() => onEdit(match.id)}\n            >\n              {t(\"matches.common.edit\")}\n            </Button>\n          ) : null}\n\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            shape=\"pill\"\n            disabled={busy}\n            onClick={() => onDelete(match.id)}\n          >\n            {t(\"matches.common.delete\")}\n          </Button>\n        </div>\n      </div>\n    </Card>\n  );\n}\n\ntype StatusPillProps = {\n  value: LoopMatchStatus;\n};\n\nfunction StatusPill({ value }: StatusPillProps) {\n  const { t } = useTranslation();\n  return (\n    <span\n      className={classNames(\n        \"inline-flex items-center\",\n        \"rounded-full px-sm py-[2px]\",\n        \"text-xs font-medium\",\n        getStatusPalette(value),\n      )}\n    >\n      {t(`matches.status.${value}`)}\n    </span>\n  );\n}\n\nfunction getStatusPalette(status: LoopMatchStatus) {\n  switch (status) {\n    case \"new\":\n      return \"bg-info text-info-foreground\";\n    case \"saved\":\n      return \"bg-secondary text-secondary-foreground\";\n    case \"applied\":\n      return \"bg-muted text-foreground\";\n    case \"interview\":\n      return \"bg-warning text-warning-foreground\";\n    case \"offer\":\n      return \"bg-success text-success-foreground\";\n    case \"rejected\":\n      return \"bg-destructive text-destructive-foreground\";\n    default:\n      return \"bg-muted text-foreground\";\n  }\n}\n","import React from \"react\";\nimport { useTranslation } from \"react-i18next\";\n\nimport { classNames } from \"src/shared/lib\";\nimport { Button, Modal } from \"src/shared/ui\";\n\nimport type { LoopMatch, LoopMatchStatus } from \"../../model/types\";\n\nimport { formatMatchedAt, normalizePlatform } from \"./matchFormat\";\n\ntype Props = Readonly<{\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n\n  match: LoopMatch;\n  loopName: string;\n\n  busy: boolean;\n\n  onDelete: (matchId: string) => void;\n  onUpdateStatus?: (matchId: string, status: LoopMatchStatus) => void;\n  onEdit?: (matchId: string) => void;\n}>;\n\nexport function MatchDetailsModal({\n  open,\n  onOpenChange,\n  match,\n  loopName,\n  busy,\n  onDelete,\n  onUpdateStatus,\n  onEdit,\n}: Props) {\n  const { t } = useTranslation();\n  const matchedAt = React.useMemo(() => formatMatchedAt(match.matchedAt), [match.matchedAt]);\n\n  const platform = React.useMemo(() => {\n    const p = normalizePlatform(match.platform);\n    return p ? p.toUpperCase() : \"\";\n  }, [match.platform]);\n\n  const meta = React.useMemo(() => {\n    const parts = [match.location, platform, matchedAt, loopName]\n      .map((v) => String(v ?? \"\").trim())\n      .filter(Boolean);\n    return parts.join(\" • \");\n  }, [match.location, platform, matchedAt, loopName]);\n\n  const statusLabel = React.useMemo(\n    () =>\n      t(`matches.status.${match.status}`, {\n        defaultValue: match.status,\n      }),\n    [match.status, t],\n  );\n\n  const title = React.useMemo(() => {\n    const raw = String(match.title ?? \"\").trim();\n    return raw ? raw : t(\"matches.details.untitled\", { defaultValue: \"Match\" });\n  }, [match.title, t]);\n\n  const url = React.useMemo(() => String(match.url ?? \"\").trim(), [match.url]);\n  const hasUrl = Boolean(url);\n\n  const description = React.useMemo(() => String(match.description ?? \"\").trim(), [match.description]);\n  const hasDescription = Boolean(description);\n\n  return (\n    <Modal\n      open={open}\n      onOpenChange={onOpenChange}\n      title={title}\n      description={meta || undefined}\n      size=\"md\"\n    >\n      <div className=\"flex flex-col gap-lg\">\n        {/* Details */}\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-md\">\n          <Field label={t(\"matches.fields.location\", { defaultValue: \"Location\" })} value={match.location} />\n          <Field label={t(\"matches.fields.platform\", { defaultValue: \"Platform\" })} value={platform} />\n          <Field label={t(\"matches.fields.matchedAt\", { defaultValue: \"Matched\" })} value={matchedAt} />\n          <Field label={t(\"matches.fields.loop\", { defaultValue: \"Loop\" })} value={loopName} />\n        </div>\n\n        {/* Description */}\n        <div>\n          <div className=\"text-sm font-semibold text-foreground\">\n            {t(\"matches.fields.description\", { defaultValue: \"Description\" })}\n          </div>\n          <div\n            className={classNames(\n              \"mt-2 rounded-xl border border-border bg-card p-md\",\n              \"text-sm leading-relaxed whitespace-pre-wrap\",\n              !hasDescription && \"text-muted-foreground\",\n            )}\n          >\n            {hasDescription ? description : t(\"matches.details.noDescription\", { defaultValue: \"No description.\" })}\n          </div>\n        </div>\n\n        {/* Actions */}\n        <div className={classNames(\"flex flex-wrap items-center justify-end gap-sm pt-sm\")}>\n          {/* Keep status visible, but do not duplicate the whole summary card */}\n          <span className=\"mr-auto rounded-full border border-border bg-card px-sm py-1 text-xs text-muted-foreground\">\n            {statusLabel}\n          </span>\n\n          {hasUrl ? (\n            <Button asChild variant=\"outline\" size=\"sm\" shape=\"pill\" disabled={busy}>\n              <a href={url} target=\"_blank\" rel=\"noreferrer\">\n                {t(\"matches.common.openLink\", { defaultValue: \"Open link\" })}\n              </a>\n            </Button>\n          ) : null}\n\n          {onUpdateStatus ? (\n            <StatusSelect\n              value={match.status}\n              disabled={busy}\n              onChange={(s) => onUpdateStatus(match.id, s)}\n            />\n          ) : null}\n\n          {onEdit ? (\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              shape=\"pill\"\n              disabled={busy}\n              onClick={() => onEdit(match.id)}\n            >\n              {t(\"matches.common.edit\", { defaultValue: \"Edit\" })}\n            </Button>\n          ) : null}\n\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            shape=\"pill\"\n            disabled={busy}\n            onClick={() => onDelete(match.id)}\n          >\n            {t(\"matches.common.delete\", { defaultValue: \"Delete\" })}\n          </Button>\n        </div>\n      </div>\n    </Modal>\n  );\n}\n\ntype FieldProps = Readonly<{ label: string; value: string | null | undefined }>;\n\nfunction Field({ label, value }: FieldProps) {\n  const v = String(value ?? \"\").trim();\n  return (\n    <div className=\"rounded-xl border border-border bg-card p-md\">\n      <div className=\"text-xs text-muted-foreground\">{label}</div>\n      <div className=\"mt-1 text-sm font-medium text-foreground whitespace-nowrap overflow-hidden text-ellipsis\">\n        {v || \"—\"}\n      </div>\n    </div>\n  );\n}\n\ntype StatusSelectProps = Readonly<{\n  value: LoopMatchStatus;\n  disabled: boolean;\n  onChange: (next: LoopMatchStatus) => void;\n}>;\n\nfunction StatusSelect({ value, disabled, onChange }: StatusSelectProps) {\n  const { t } = useTranslation();\n  const options: LoopMatchStatus[] = [\"new\", \"saved\", \"interview\", \"offer\", \"applied\", \"rejected\"];\n\n  return (\n    <label className=\"flex items-center gap-sm text-sm\">\n      <span className=\"text-muted-foreground\">{t(\"matches.common.status\", { defaultValue: \"Status\" })}</span>\n      <select\n        value={value}\n        disabled={disabled}\n        onChange={(e) => onChange(e.target.value as LoopMatchStatus)}\n        className={classNames(\n          \"h-9 rounded-full px-sm\",\n          \"border border-border bg-card text-foreground\",\n          \"focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background\",\n        )}\n      >\n        {options.map((s) => (\n          <option key={s} value={s}>\n            {t(`matches.status.${s}`, { defaultValue: s })}\n          </option>\n        ))}\n      </select>\n    </label>\n  );\n}\n"],"names":["toMsg","e","Error","message","String","rtkError","error","makeTimestamps","iso","Date","toISOString","server","serverTimestamp","normalizeUrl","input","v","trim","test","mapLoopMatchDoc","id","data","rest","createdAtTs","updatedAtTs","loopMatchesApi","baseApi","injectEndpoints","endpoints","builder","getAllMatches","query","queryFn","_arg","api","uid","requireUidFromState","getState","q","userLoopMatchesCol","orderBy","getDocs","docs","map","d","providesTags","res","m","type","getMatchesByLoop","loopId","where","_res","_err","arg","getMatch","matchId","snap","getDoc","userLoopMatchDoc","exists","createMatch","mutation","payload","url","createdAt","updatedAt","addDoc","invalidatesTags","_r","_e","updateMatchStatus","status","updateDoc","undefined","updateMatch","patch","cleaned","out","cleanPatch","deleteMatch","deleteDoc","useGetAllMatchesQuery","useGetMatchesByLoopQuery","useGetMatchQuery","useCreateMatchMutation","useUpdateMatchStatusMutation","useUpdateMatchMutation","useDeleteMatchMutation","knownPlatforms","Set","PLATFORM_REGISTRY","p","normalizePlatform","toLowerCase","has","formatMatchedAt","Number","isNaN","getTime","yyyy","getFullYear","mm","getMonth","padStart","getDate","STATUS_OPTIONS","MatchCard","match","loopName","busy","onUpdateStatus","onDelete","onEdit","t","useTranslation","matchedAt","React","platform","toUpperCase","meta","location","filter","Boolean","join","_jsxs","Card","variant","padding","shadow","className","children","_jsx","title","company","StatusPill","value","disabled","onChange","target","classNames","s","Button","size","shape","onClick","getStatusPalette","MatchDetailsModal","open","onOpenChange","statusLabel","defaultValue","hasUrl","description","hasDescription","Modal","Field","label","asChild","href","rel","StatusSelect"],"ignoreList":[],"sourceRoot":""}