"use strict";(self.webpackChunkjob_tracker_dashboard=self.webpackChunkjob_tracker_dashboard||[]).push([[7804],{77804(e,t,a){a.r(t),a.d(t,{default:()=>j});var s=a(96540),l=a(22022),i=a(3433),n=a(3626),r=a(71563),c=a(67167),d=a(96788),o=a(46681),u=a(89921),m=a(74848);function p(e){switch(e){case"SAVED":return"SAVED";case"PLANNED":return"PLANNED";case"APPLIED":return"APPLIED";case"VIEWED":return"VIEWED";case"INTERVIEW_1":return"INTERVIEW";case"INTERVIEW_2":return"INTERVIEW 2";case"TEST_TASK":return"TEST TASK";case"OFFER":return"OFFER";case"REJECTED":return"REJECTED";case"NO_RESPONSE":return"NO RESPONSE";default:return e}}const f=["SAVED","APPLIED","INTERVIEW_1","OFFER","REJECTED","NO_RESPONSE"];function x(e){if(!e)return"";try{const t=e;return("function"==typeof t?.toDate?t.toDate():new Date(e)).toLocaleString()}catch{return""}}function h(e){if(e instanceof Error)return e.message;if("string"==typeof e)return e;try{return JSON.stringify(e)}catch{return String(e)}}function j(){const{t:e}=(0,l.Bd)(),t=(0,i.Zp)(),{appId:a}=(0,i.g)(),{userId:j,isAuthReady:b}=(0,r.gv)(),[N,g]=(0,s.useState)(null),[y,v]=(0,s.useState)([]),[D,E]=(0,s.useState)(!1),[O,S]=(0,s.useState)(!1),[V,A]=(0,s.useState)(null),[C,T]=(0,s.useState)(""),[w,k]=(0,s.useState)("all"),R=(0,s.useMemo)(()=>N?`${N.job.roleTitle} • ${N.job.companyName}`:"",[N]),I=(0,s.useMemo)(()=>{if(D)return(0,m.jsx)("div",{className:"text-sm text-muted-foreground",children:e("applicationDetails.loading",{defaultValue:"Loading…",returnObjects:!1})??"Loading…"});if(!N)return(0,m.jsx)("div",{className:"text-sm text-muted-foreground",children:e("applicationDetails.notFound",{defaultValue:"Not found",returnObjects:!1})??"Not found"});const t=N.process.needsFollowUp?e("applicationDetails.yes",{defaultValue:"Yes",returnObjects:!1})??"Yes":e("applicationDetails.no",{defaultValue:"No",returnObjects:!1})??"No",a=N.process.followUpDueAt?`(${x(N.process.followUpDueAt)})`:"",s=N.process.needsReapplySuggestion?e("applicationDetails.yes",{defaultValue:"Yes",returnObjects:!1})??"Yes":e("applicationDetails.no",{defaultValue:"No",returnObjects:!1})??"No",l=N.process.reapplyEligibleAt?`(${x(N.process.reapplyEligibleAt)})`:"";return(0,m.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,m.jsxs)("div",{children:[(0,m.jsxs)("span",{className:"text-muted-foreground",children:[e("applicationDetails.company",{defaultValue:"Company",returnObjects:!1})??"Company",":"]})," ",N.job.companyName]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("span",{className:"text-muted-foreground",children:[e("applicationDetails.role",{defaultValue:"Role",returnObjects:!1})??"Role",":"]})," ",N.job.roleTitle]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("span",{className:"text-muted-foreground",children:[e("applicationDetails.source",{defaultValue:"Source",returnObjects:!1})??"Source",":"]})," ",N.job.source||"—"]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("span",{className:"text-muted-foreground",children:[e("applicationDetails.status",{defaultValue:"Status",returnObjects:!1})??"Status",":"]})," ",p(N.process.status)]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("span",{className:"text-muted-foreground",children:[e("applicationDetails.followup",{defaultValue:"Follow-up",returnObjects:!1})??"Follow-up",":"]})," ",t," ",a]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("span",{className:"text-muted-foreground",children:[e("applicationDetails.reapply",{defaultValue:"Re-apply",returnObjects:!1})??"Re-apply",":"]})," ",s," ",l]})]})},[N,D,e]),P=(0,s.useMemo)(()=>"all"===w?y:"statuses"===w?y.filter(e=>"STATUS_CHANGE"===e.data.type):y.filter(e=>"COMMENT"===e.data.type),[y,w]);async function F(){if(j&&a){E(!0),A(null);try{const e=await(0,c.Di)(d.db,j,a);g(e);const t=await(0,c.b7)(d.db,j,a,50);v(t)}catch(e){A(h(e))}finally{E(!1)}}}return(0,s.useEffect)(()=>{b&&j&&a&&F()},[b,j,a]),(0,m.jsxs)("div",{className:"space-y-lg",children:[(0,m.jsxs)("div",{className:"flex items-start justify-between gap-md",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("div",{className:"text-sm text-muted-foreground",children:(0,m.jsx)("button",{type:"button",className:"hover:underline",onClick:()=>t(n.RU[n.Sb.APPLICATIONS]),children:e("applicationDetails.back",{defaultValue:"← Back to applications",returnObjects:!1})??"← Back to applications"})}),(0,m.jsx)("div",{className:"text-xl font-semibold text-foreground",children:R||(e("applicationDetails.titleFallback",{defaultValue:"Application",returnObjects:!1})??"Application")}),N?.job.vacancyUrl?(0,m.jsx)("div",{className:"text-sm text-muted-foreground break-all",children:(0,m.jsx)("a",{className:"hover:underline",href:N.job.vacancyUrl,target:"_blank",rel:"noreferrer",children:N.job.vacancyUrl})}):null]}),(0,m.jsxs)("div",{className:"flex items-center gap-sm",children:[(0,m.jsx)("div",{className:"rounded-full border border-border bg-muted px-3 py-1 text-[12px] font-medium text-foreground",children:N?p(N.process.status):"—"}),N?.priority?(0,m.jsxs)("div",{className:"rounded-full border border-border bg-background px-3 py-1 text-[12px] font-medium text-foreground",children:[e("applicationDetails.priority",{defaultValue:"Priority",returnObjects:!1})??"Priority",": ",N.priority.score]}):null]})]}),V?(0,m.jsx)(o.Wz,{message:V}):null,(0,m.jsxs)(o.Zp,{padding:"md",shadow:"sm",className:"space-y-md",children:[(0,m.jsx)("div",{className:"text-base font-semibold",children:e("applicationDetails.actions",{defaultValue:"Actions",returnObjects:!1})??"Actions"}),(0,m.jsx)("div",{className:"flex flex-wrap gap-sm",children:f.map(e=>(0,m.jsx)(o.$n,{size:"sm",variant:N?.process.status===e?"default":"outline",disabled:!N||O,onClick:()=>async function(e){if(j&&a){S(!0),A(null);try{await(0,c.zQ)(d.db,j,a,e),await F()}catch(e){A(h(e))}finally{S(!1)}}}(e),children:p(e)},e))}),(0,m.jsxs)("div",{className:"space-y-2",children:[(0,m.jsx)("div",{className:"text-sm font-semibold",children:e("applicationDetails.comment",{defaultValue:"Add comment",returnObjects:!1})??"Add comment"}),(0,m.jsxs)("div",{className:"flex gap-sm",children:[(0,m.jsx)(u.pd,{preset:"default",value:C,onChange:e=>T(e.target.value),placeholder:e("applicationDetails.commentPh",{defaultValue:"Write a short note…",returnObjects:!1})??"Write a short note…"}),(0,m.jsx)(o.$n,{disabled:!C.trim()||O,onClick:async function(){if(!j||!a)return;const e=C.trim();if(e){S(!0),A(null);try{await(0,c.BC)(d.db,j,a,{text:e}),T(""),await F()}catch(e){A(h(e))}finally{S(!1)}}},children:e("applicationDetails.add",{defaultValue:"Add",returnObjects:!1})??"Add"})]})]})]}),(0,m.jsxs)("div",{className:"grid grid-cols-1 gap-md lg:grid-cols-2",children:[(0,m.jsxs)(o.Zp,{padding:"md",shadow:"sm",className:"space-y-sm",children:[(0,m.jsx)("div",{className:"text-base font-semibold",children:e("applicationDetails.summary",{defaultValue:"Summary",returnObjects:!1})??"Summary"}),I]}),(0,m.jsxs)(o.Zp,{padding:"md",shadow:"sm",className:"space-y-sm",children:[(0,m.jsx)("div",{className:"text-base font-semibold",children:e("applicationDetails.matching",{defaultValue:"Matching",returnObjects:!1})??"Matching"}),N?.matching?(0,m.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,m.jsxs)("div",{children:[(0,m.jsxs)("span",{className:"text-muted-foreground",children:[e("applicationDetails.decision",{defaultValue:"Decision",returnObjects:!1})??"Decision",":"]})," ",(0,m.jsx)("span",{className:"font-medium",children:N.matching.decision})," ",(0,m.jsxs)("span",{className:"text-muted-foreground",children:["(",N.matching.score,"/100)"]})]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("span",{className:"text-muted-foreground",children:[e("applicationDetails.matched",{defaultValue:"Matched",returnObjects:!1})??"Matched",":"]})," ",N.matching.matchedSkillsTop.length?N.matching.matchedSkillsTop.join(", "):"—"]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("span",{className:"text-muted-foreground",children:[e("applicationDetails.gaps",{defaultValue:"Gaps",returnObjects:!1})??"Gaps",":"]})," ",N.matching.gapsTop.length?N.matching.gapsTop.join(", "):"—"]}),(0,m.jsxs)("div",{className:"text-xs text-muted-foreground",children:[e("applicationDetails.computedAt",{defaultValue:"Computed",returnObjects:!1})??"Computed"," ",x(N.matching.computedAt)," • ",e("applicationDetails.confidence",{defaultValue:"Confidence",returnObjects:!1})??"Confidence"," ",Math.round(100*N.matching.confidence),"%"]})]}):(0,m.jsx)("div",{className:"text-sm text-muted-foreground",children:e("applicationDetails.noMatching",{defaultValue:"No matching data yet. Add description or skills.",returnObjects:!1})??"No matching data yet. Add description or skills."})]})]}),(0,m.jsxs)(o.Zp,{padding:"md",shadow:"sm",className:"space-y-sm",children:[(0,m.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,m.jsx)("div",{className:"text-base font-semibold",children:e("applicationDetails.history",{defaultValue:"History",returnObjects:!1})??"History"}),(0,m.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,m.jsx)(o.$n,{size:"sm",variant:"all"===w?"default":"outline",onClick:()=>k("all"),children:e("applicationDetails.historyFilter.all",{defaultValue:"All",returnObjects:!1})??"All"}),(0,m.jsx)(o.$n,{size:"sm",variant:"statuses"===w?"default":"outline",onClick:()=>k("statuses"),children:e("applicationDetails.historyFilter.statuses",{defaultValue:"Statuses",returnObjects:!1})??"Statuses"}),(0,m.jsx)(o.$n,{size:"sm",variant:"comments"===w?"default":"outline",onClick:()=>k("comments"),children:e("applicationDetails.historyFilter.comments",{defaultValue:"Comments",returnObjects:!1})??"Comments"})]})]}),0===P.length?(0,m.jsx)("div",{className:"text-sm text-muted-foreground",children:e("applicationDetails.noHistory",{defaultValue:"No history yet.",returnObjects:!1})??"No history yet."}):(0,m.jsx)("div",{className:"divide-y divide-border",children:P.map(e=>{return(0,m.jsxs)("div",{className:"py-sm",children:[(0,m.jsx)("div",{className:"text-sm font-medium text-foreground",children:(t=e.data,"STATUS_CHANGE"===t.type?`Status: ${t.fromStatus} → ${t.toStatus}`:"COMMENT"===t.type?"Comment":"FIELD_CHANGE"===t.type?`Field: ${t.fieldPath}`:t.comment?t.comment:"System")}),(0,m.jsxs)("div",{className:"text-xs text-muted-foreground",children:[x(e.data.createdAt)," • ",e.data.actor]}),e.data.comment?(0,m.jsx)("div",{className:"mt-1 text-sm text-foreground",children:e.data.comment}):null]},e.id);var t})})]})]})}}}]);
//# sourceMappingURL=7804.5bbb9302.chunk.js.map