{"version":3,"file":"assets/js/7804.5bbb9302.chunk.js","mappings":"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","sources":["webpack://job-tracker-dashboard/./src/pages/ApplicationDetailsPage/ApplicationDetailsPage.tsx"],"sourcesContent":["import { useEffect, useMemo, useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { useNavigate, useParams } from \"react-router-dom\";\n\nimport { AppRoutes, RoutePath } from \"src/app/providers/router/routeConfig/routeConfig\";\nimport { useAuthSelectors } from \"src/entities/auth\";\nimport {\n  type ApplicationDoc,\n  type ProcessStatus,\n  type HistoryEventDoc,\n  getApplication,\n  getApplicationHistory,\n  changeStatus,\n  addComment,\n} from \"src/features/applications/firestoreApplications\";\nimport { db } from \"src/shared/config/firebase/firebase\";\nimport { Button, Card, InlineError } from \"src/shared/ui\";\nimport { Input } from \"src/shared/ui/Form/Input\";\n\n\n\nfunction statusLabel(status: ProcessStatus): string {\n  switch (status) {\n    case \"SAVED\":\n      return \"SAVED\";\n    case \"PLANNED\":\n      return \"PLANNED\";\n    case \"APPLIED\":\n      return \"APPLIED\";\n    case \"VIEWED\":\n      return \"VIEWED\";\n    case \"INTERVIEW_1\":\n      return \"INTERVIEW\";\n    case \"INTERVIEW_2\":\n      return \"INTERVIEW 2\";\n    case \"TEST_TASK\":\n      return \"TEST TASK\";\n    case \"OFFER\":\n      return \"OFFER\";\n    case \"REJECTED\":\n      return \"REJECTED\";\n    case \"NO_RESPONSE\":\n      return \"NO RESPONSE\";\n    default:\n      return status;\n  }\n}\n\nconst STATUS_BUTTONS: ProcessStatus[] = [\n  \"SAVED\",\n  \"APPLIED\",\n  \"INTERVIEW_1\",\n  \"OFFER\",\n  \"REJECTED\",\n  \"NO_RESPONSE\",\n];\n\nfunction formatTs(ts: unknown): string {\n  if (!ts) return \"\";\n  try {\n    const maybe = ts as { toDate?: unknown };\n    const d =\n      typeof maybe?.toDate === \"function\"\n        ? (maybe.toDate as () => Date)()\n        : new Date(ts as never);\n    return d.toLocaleString();\n  } catch {\n    return \"\";\n  }\n}\n\nfunction errorMessage(e: unknown): string {\n  if (e instanceof Error) return e.message;\n  if (typeof e === \"string\") return e;\n  try {\n    return JSON.stringify(e);\n  } catch {\n    return String(e);\n  }\n}\n\nfunction historyTitle(ev: HistoryEventDoc): string {\n  if (ev.type === \"STATUS_CHANGE\") return `Status: ${ev.fromStatus} → ${ev.toStatus}`;\n  if (ev.type === \"COMMENT\") return `Comment`;\n  if (ev.type === \"FIELD_CHANGE\") return `Field: ${ev.fieldPath}`;\n  return ev.comment ? ev.comment : \"System\";\n}\n\nexport default function ApplicationDetailsPage() {\n  const { t } = useTranslation();\n  const navigate = useNavigate();\n  const { appId } = useParams<{ appId: string }>();\n  const { userId, isAuthReady } = useAuthSelectors();\n\n  const [app, setApp] = useState<ApplicationDoc | null>(null);\n  const [history, setHistory] = useState<Array<{ id: string; data: HistoryEventDoc }>>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isMutating, setIsMutating] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const [commentText, setCommentText] = useState(\"\");\n\n  const [historyFilter, setHistoryFilter] = useState<\"all\" | \"statuses\" | \"comments\">(\"all\");\n\n  const title = useMemo(() => {\n    if (!app) return \"\";\n    return `${app.job.roleTitle} • ${app.job.companyName}`;\n  }, [app]);\n\n  const summaryNode = useMemo(() => {\n    if (isLoading) {\n\n  return (\n        <div className=\"text-sm text-muted-foreground\">\n          {(t(\"applicationDetails.loading\", { defaultValue: \"Loading…\", returnObjects: false }) ?? \"Loading…\") as string}\n        </div>\n      );\n    }\n\n    if (!app) {\n      return (\n        <div className=\"text-sm text-muted-foreground\">\n          {(t(\"applicationDetails.notFound\", { defaultValue: \"Not found\", returnObjects: false }) ?? \"Not found\") as string}\n        </div>\n      );\n    }\n\n    const followUpYesNo = app.process.needsFollowUp\n      ? (t(\"applicationDetails.yes\", { defaultValue: \"Yes\", returnObjects: false }) ?? \"Yes\") as string\n      : (t(\"applicationDetails.no\", { defaultValue: \"No\", returnObjects: false }) ?? \"No\") as string;\n    const followUpDue = app.process.followUpDueAt\n      ? `(${formatTs(app.process.followUpDueAt)})`\n      : \"\";\n\n    const reapplyYesNo = app.process.needsReapplySuggestion\n      ? (t(\"applicationDetails.yes\", { defaultValue: \"Yes\", returnObjects: false }) ?? \"Yes\") as string\n      : (t(\"applicationDetails.no\", { defaultValue: \"No\", returnObjects: false }) ?? \"No\") as string;\n    const reapplyAt = app.process.reapplyEligibleAt\n      ? `(${formatTs(app.process.reapplyEligibleAt)})`\n      : \"\";\n\n    return (\n      <div className=\"space-y-2 text-sm\">\n        <div>\n          <span className=\"text-muted-foreground\">\n            {(t(\"applicationDetails.company\", { defaultValue: \"Company\", returnObjects: false }) ?? \"Company\") as string}:\n          </span>{\" \"}\n          {app.job.companyName}\n        </div>\n        <div>\n          <span className=\"text-muted-foreground\">{(t(\"applicationDetails.role\", { defaultValue: \"Role\", returnObjects: false }) ?? \"Role\") as string}:</span>{\" \"}\n          {app.job.roleTitle}\n        </div>\n        <div>\n          <span className=\"text-muted-foreground\">\n            {(t(\"applicationDetails.source\", { defaultValue: \"Source\", returnObjects: false }) ?? \"Source\") as string}:\n          </span>{\" \"}\n          {app.job.source || \"—\"}\n        </div>\n        <div>\n          <span className=\"text-muted-foreground\">\n            {(t(\"applicationDetails.status\", { defaultValue: \"Status\", returnObjects: false }) ?? \"Status\") as string}:\n          </span>{\" \"}\n          {statusLabel(app.process.status)}\n        </div>\n        <div>\n          <span className=\"text-muted-foreground\">\n            {(t(\"applicationDetails.followup\", { defaultValue: \"Follow-up\", returnObjects: false }) ?? \"Follow-up\") as string}:\n          </span>{\" \"}\n          {followUpYesNo} {followUpDue}\n        </div>\n        <div>\n          <span className=\"text-muted-foreground\">\n            {(t(\"applicationDetails.reapply\", { defaultValue: \"Re-apply\", returnObjects: false }) ?? \"Re-apply\") as string}:\n          </span>{\" \"}\n          {reapplyYesNo} {reapplyAt}\n        </div>\n      </div>\n    );\n  }, [app, isLoading, t]);\n\n  const filteredHistory = useMemo(() => {\n    if (historyFilter === \"all\") return history;\n    if (historyFilter === \"statuses\") {\n      return history.filter((h) => h.data.type === \"STATUS_CHANGE\");\n    }\n    // comments\n    return history.filter((h) => h.data.type === \"COMMENT\");\n  }, [history, historyFilter]);\n\n  async function load() {\n    if (!userId || !appId) return;\n    setIsLoading(true);\n    setError(null);\n    try {\n      const a = await getApplication(db, userId, appId);\n      setApp(a);\n      const h = await getApplicationHistory(db, userId, appId, 50);\n      setHistory(h);\n    } catch (e: unknown) {\n      setError(errorMessage(e));\n    } finally {\n      setIsLoading(false);\n    }\n  }\n\n  useEffect(() => {\n    if (!isAuthReady || !userId || !appId) return;\n    void load();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isAuthReady, userId, appId]);\n\n  async function onChangeStatus(next: ProcessStatus) {\n    if (!userId || !appId) return;\n    setIsMutating(true);\n    setError(null);\n    try {\n      await changeStatus(db, userId, appId, next);\n      await load();\n    } catch (e: unknown) {\n      setError(errorMessage(e));\n    } finally {\n      setIsMutating(false);\n    }\n  }\n\n  async function onAddComment() {\n    if (!userId || !appId) return;\n    const text = commentText.trim();\n    if (!text) return;\n\n    setIsMutating(true);\n    setError(null);\n    try {\n      await addComment(db, userId, appId, { text });\n      setCommentText(\"\");\n      await load();\n    } catch (e: unknown) {\n      setError(errorMessage(e));\n    } finally {\n      setIsMutating(false);\n    }\n  }\n\n  return (\n    <div className=\"space-y-lg\">\n      <div className=\"flex items-start justify-between gap-md\">\n        <div>\n          <div className=\"text-sm text-muted-foreground\">\n            <button\n              type=\"button\"\n              className=\"hover:underline\"\n              onClick={() => navigate(RoutePath[AppRoutes.APPLICATIONS])}\n            >\n              {(t(\"applicationDetails.back\", { defaultValue: \"← Back to applications\", returnObjects: false }) ?? \"← Back to applications\") as string}\n            </button>\n          </div>\n          <div className=\"text-xl font-semibold text-foreground\">\n            {title || (t(\"applicationDetails.titleFallback\", { defaultValue: \"Application\", returnObjects: false }) ?? \"Application\") as string}\n          </div>\n          {app?.job.vacancyUrl ? (\n            <div className=\"text-sm text-muted-foreground break-all\">\n              <a className=\"hover:underline\" href={app.job.vacancyUrl} target=\"_blank\" rel=\"noreferrer\">\n                {app.job.vacancyUrl}\n              </a>\n            </div>\n          ) : null}\n        </div>\n\n        <div className=\"flex items-center gap-sm\">\n          <div className=\"rounded-full border border-border bg-muted px-3 py-1 text-[12px] font-medium text-foreground\">\n            {app ? statusLabel(app.process.status) : \"—\"}\n          </div>\n          {app?.priority ? (\n            <div className=\"rounded-full border border-border bg-background px-3 py-1 text-[12px] font-medium text-foreground\">\n              {(t(\"applicationDetails.priority\", { defaultValue: \"Priority\", returnObjects: false }) ?? \"Priority\") as string}: {app.priority.score}\n            </div>\n          ) : null}\n        </div>\n      </div>\n\n      {error ? <InlineError message={error} /> : null}\n\n      <Card padding=\"md\" shadow=\"sm\" className=\"space-y-md\">\n        <div className=\"text-base font-semibold\">{(t(\"applicationDetails.actions\", { defaultValue: \"Actions\", returnObjects: false }) ?? \"Actions\") as string}</div>\n        <div className=\"flex flex-wrap gap-sm\">\n          {STATUS_BUTTONS.map((s) => (\n            <Button\n              key={s}\n              size=\"sm\"\n              variant={app?.process.status === s ? \"default\" : \"outline\"}\n              disabled={!app || isMutating}\n              onClick={() => onChangeStatus(s)}\n            >\n              {statusLabel(s)}\n            </Button>\n          ))}\n        </div>\n\n        <div className=\"space-y-2\">\n          <div className=\"text-sm font-semibold\">{(t(\"applicationDetails.comment\", { defaultValue: \"Add comment\", returnObjects: false }) ?? \"Add comment\") as string}</div>\n          <div className=\"flex gap-sm\">\n            <Input\n              preset=\"default\"\n              value={commentText}\n              onChange={(e) => setCommentText(e.target.value)}\n              placeholder={(t(\"applicationDetails.commentPh\", { defaultValue: \"Write a short note…\", returnObjects: false }) ?? \"Write a short note…\") as string}\n            />\n            <Button disabled={!commentText.trim() || isMutating} onClick={onAddComment}>\n              {(t(\"applicationDetails.add\", { defaultValue: \"Add\", returnObjects: false }) ?? \"Add\") as string}\n            </Button>\n          </div>\n        </div>\n      </Card>\n\n      <div className=\"grid grid-cols-1 gap-md lg:grid-cols-2\">\n        <Card padding=\"md\" shadow=\"sm\" className=\"space-y-sm\">\n          <div className=\"text-base font-semibold\">{(t(\"applicationDetails.summary\", { defaultValue: \"Summary\", returnObjects: false }) ?? \"Summary\") as string}</div>\n          {summaryNode}\n        </Card>\n\n        <Card padding=\"md\" shadow=\"sm\" className=\"space-y-sm\">\n          <div className=\"text-base font-semibold\">{(t(\"applicationDetails.matching\", { defaultValue: \"Matching\", returnObjects: false }) ?? \"Matching\") as string}</div>\n          {!app?.matching ? (\n            <div className=\"text-sm text-muted-foreground\">{(t(\"applicationDetails.noMatching\", { defaultValue: \"No matching data yet. Add description or skills.\", returnObjects: false }) ?? \"No matching data yet. Add description or skills.\") as string}</div>\n          ) : (\n            <div className=\"space-y-2 text-sm\">\n              <div>\n                <span className=\"text-muted-foreground\">{(t(\"applicationDetails.decision\", { defaultValue: \"Decision\", returnObjects: false }) ?? \"Decision\") as string}:</span>{\" \"}\n                <span className=\"font-medium\">{app.matching.decision}</span>{\" \"}\n                <span className=\"text-muted-foreground\">({app.matching.score}/100)</span>\n              </div>\n              <div>\n                <span className=\"text-muted-foreground\">{(t(\"applicationDetails.matched\", { defaultValue: \"Matched\", returnObjects: false }) ?? \"Matched\") as string}:</span>{\" \"}\n                {app.matching.matchedSkillsTop.length ? app.matching.matchedSkillsTop.join(\", \") : \"—\"}\n              </div>\n              <div>\n                <span className=\"text-muted-foreground\">{(t(\"applicationDetails.gaps\", { defaultValue: \"Gaps\", returnObjects: false }) ?? \"Gaps\") as string}:</span>{\" \"}\n                {app.matching.gapsTop.length ? app.matching.gapsTop.join(\", \") : \"—\"}\n              </div>\n              <div className=\"text-xs text-muted-foreground\">\n                {(t(\"applicationDetails.computedAt\", { defaultValue: \"Computed\", returnObjects: false }) ?? \"Computed\") as string} {formatTs(app.matching.computedAt)} • {(t(\"applicationDetails.confidence\", { defaultValue: \"Confidence\", returnObjects: false }) ?? \"Confidence\") as string} {Math.round(app.matching.confidence * 100)}%\n              </div>\n            </div>\n          )}\n        </Card>\n      </div>\n\n      <Card padding=\"md\" shadow=\"sm\" className=\"space-y-sm\">\n        <div className=\"flex flex-wrap items-center justify-between gap-3\">\n        <div className=\"text-base font-semibold\">\n          {((t(\"applicationDetails.history\", { defaultValue: \"History\", returnObjects: false }) ?? \"History\") as string)}\n        </div>\n\n        <div className=\"flex flex-wrap gap-2\">\n          <Button\n            size=\"sm\"\n            variant={historyFilter === \"all\" ? \"default\" : \"outline\"}\n            onClick={() => setHistoryFilter(\"all\")}\n          >\n            {((t(\"applicationDetails.historyFilter.all\", { defaultValue: \"All\", returnObjects: false }) ?? \"All\") as string)}\n          </Button>\n          <Button\n            size=\"sm\"\n            variant={historyFilter === \"statuses\" ? \"default\" : \"outline\"}\n            onClick={() => setHistoryFilter(\"statuses\")}\n          >\n            {((t(\"applicationDetails.historyFilter.statuses\", { defaultValue: \"Statuses\", returnObjects: false }) ?? \"Statuses\") as string)}\n          </Button>\n          <Button\n            size=\"sm\"\n            variant={historyFilter === \"comments\" ? \"default\" : \"outline\"}\n            onClick={() => setHistoryFilter(\"comments\")}\n          >\n            {((t(\"applicationDetails.historyFilter.comments\", { defaultValue: \"Comments\", returnObjects: false }) ?? \"Comments\") as string)}\n          </Button>\n        </div>\n      </div>\n        {filteredHistory.length === 0 ? (\n          <div className=\"text-sm text-muted-foreground\">{(t(\"applicationDetails.noHistory\", { defaultValue: \"No history yet.\", returnObjects: false }) ?? \"No history yet.\") as string}</div>\n        ) : (\n          <div className=\"divide-y divide-border\">\n            {filteredHistory.map((h) => (\n              <div key={h.id} className=\"py-sm\">\n                <div className=\"text-sm font-medium text-foreground\">{historyTitle(h.data)}</div>\n                <div className=\"text-xs text-muted-foreground\">\n                  {formatTs(h.data.createdAt)} • {h.data.actor}\n                </div>\n                {h.data.comment ? (\n                  <div className=\"mt-1 text-sm text-foreground\">{h.data.comment}</div>\n                ) : null}\n              </div>\n            ))}\n          </div>\n        )}\n      </Card>\n    </div>\n  );\n}\n"],"names":["statusLabel","status","STATUS_BUTTONS","formatTs","ts","maybe","toDate","Date","toLocaleString","errorMessage","e","Error","message","JSON","stringify","String","ApplicationDetailsPage","t","useTranslation","navigate","useNavigate","appId","useParams","userId","isAuthReady","useAuthSelectors","app","setApp","useState","history","setHistory","isLoading","setIsLoading","isMutating","setIsMutating","error","setError","commentText","setCommentText","historyFilter","setHistoryFilter","title","useMemo","job","roleTitle","companyName","summaryNode","_jsx","className","children","defaultValue","returnObjects","followUpYesNo","process","needsFollowUp","followUpDue","followUpDueAt","reapplyYesNo","needsReapplySuggestion","reapplyAt","reapplyEligibleAt","_jsxs","source","filteredHistory","filter","h","data","type","async","load","a","getApplication","db","getApplicationHistory","useEffect","onClick","RoutePath","AppRoutes","APPLICATIONS","vacancyUrl","href","target","rel","priority","score","InlineError","Card","padding","shadow","map","s","Button","size","variant","disabled","next","changeStatus","onChangeStatus","Input","preset","value","onChange","placeholder","trim","text","addComment","matching","decision","matchedSkillsTop","length","join","gapsTop","computedAt","Math","round","confidence","ev","fromStatus","toStatus","fieldPath","comment","createdAt","actor","id"],"ignoreList":[],"sourceRoot":""}