"use strict";(self.webpackChunkjob_tracker_dashboard=self.webpackChunkjob_tracker_dashboard||[]).push([[4012],{338(e,l,o){function a(e,l,o,a={replace:!0}){const s=new URLSearchParams(l.search);for(const[e,l]of Object.entries(o))null!=l&&!1!==l?!0!==l?s.set(e,String(l)):s.set(e,"1"):s.delete(e);const r=s.toString();e({pathname:l.pathname,search:r?`?${r}`:""},{replace:a.replace??!0})}o.d(l,{N:()=>a})},24012(e,l,o){o.r(l),o.d(l,{default:()=>G});var a=o(22022),s=o(3433),r=o(71563),t=o(46681),n=o(96540),i=o(74848);function d({title:e,subtitle:l,right:o}){return(0,i.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-2xl font-semibold text-foreground",children:e}),l?(0,i.jsx)("div",{className:"mt-1 text-sm text-muted-foreground",children:l}):null]}),o]})}function c({children:e}){return(0,i.jsx)("div",{className:"rounded-2xl border border-border bg-card p-6 text-sm text-muted-foreground",children:e})}var u=o(43578),p=o(14603),m=o(82284);function h(e){return"object"==typeof e&&null!==e}function f(e,l){return"string"==typeof e?e:l}function x(e,l){const o="number"==typeof e?e:Number(e);return Number.isFinite(o)?o:l}function g(e,l,o){return l.includes(e)?e:o}function b(e){return e.map(e=>String(e??"").trim()).filter(Boolean).join(" OR ")}o(56258);var v=o(99653),y=o(95531),j=o(7425),N=o(12664),w=o(15019),k=o(82207);const C=[{needle:"linkedin.com",platform:"linkedin"},{needle:"indeed.",platform:"indeed"},{needle:"glassdoor.",platform:"glassdoor"},{needle:"monster.",platform:"monster"},{needle:"stepstone.",platform:"stepstone"},{needle:"xing.",platform:"xing"},{needle:"github.com",platform:"github"},{needle:"wellfound.",platform:"wellfound"},{needle:"angel.co",platform:"wellfound"},{needle:"levels.fyi",platform:"levels"}];var B=o(95310);const M=B.WI.map(e=>e.value),S=B.YN.map(e=>e.value);function R({open:e,onOpenChange:l,loopId:o,defaultPlatform:s}){const{t:r}=(0,a.Bd)(),[d,c]=(0,w._H)(),u=(0,n.useMemo)(()=>function(e){return N.Ik({title:N.Yj().trim().min(2,e("loops.validation.titleRequired",{defaultValue:"Title is required"})).required(e("loops.validation.titleRequired",{defaultValue:"Title is required"})),company:N.Yj().trim().min(2,e("loops.validation.companyRequired",{defaultValue:"Company is required"})).required(e("loops.validation.companyRequired",{defaultValue:"Company is required"})),location:N.Yj().trim().min(2,e("loops.validation.locationRequired",{defaultValue:"Location is required"})).required(e("loops.validation.locationRequired",{defaultValue:"Location is required"})),platform:N.gl().oneOf(M).required(e("loops.validation.platformRequired",{defaultValue:"Platform is required"})),url:N.Yj().trim().required(e("loops.validation.urlRequired",{defaultValue:"Job URL is required"})).test("is-url",e("loops.validation.invalidUrl",{defaultValue:"Invalid URL"}),e=>Boolean(function(e){const l=e.trim();if(!l)return null;try{return new URL(l)}catch{try{return new URL(`https://${l}`)}catch{return null}}}(e??""))),description:N.Yj().trim().min(1,e("loops.validation.descriptionRequired",{defaultValue:"Description is required"})).required(e("loops.validation.descriptionRequired",{defaultValue:"Description is required"})),status:N.gl().oneOf(S).required(e("loops.validation.statusRequired",{defaultValue:"Status is required"})),matchedAt:N.Yj().trim().required()})}(r),[r]),p=(0,n.useRef)(!1);(0,n.useEffect)(()=>{e&&(p.current=!1)},[e]);const m=(0,n.useMemo)(()=>{return{title:"",company:"",location:"",platform:(e=s,e??"linkedin"),url:"",description:"",status:"SAVED",matchedAt:(new Date).toISOString()};var e},[s]),h=c.isLoading;return(0,i.jsx)(t.aF,{open:e,onOpenChange:l,title:r("loops.addMatch",{defaultValue:"Add match"}),description:r("loops.addMatchDescription",{defaultValue:"Paste the job URL and fill details. This saves a match to your loop."}),children:(0,i.jsx)(j.l1,{initialValues:m,enableReinitialize:!0,validationSchema:u,onSubmit:async(e,a)=>{a.setStatus(void 0);try{await d({loopId:o,title:e.title,company:e.company,location:e.location,platform:e.platform,url:e.url,description:e.description,status:e.status,matchedAt:e.matchedAt}).unwrap(),l(!1)}catch(e){a.setStatus((0,v.u1)(e)||r("loops.failedToSaveMatch",{defaultValue:"Failed to save match"}))}},children:e=>{const o=("string"==typeof e.status?e.status:void 0)||(c.isError?(0,v.u1)(c.error):void 0),a=!h&&e.dirty;return(0,i.jsxs)("form",{onSubmit:e.handleSubmit,className:"space-y-4",children:[o?(0,i.jsx)(t.Wz,{message:o}):null,(0,i.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,i.jsx)(k.z,{label:r("loops.jobTitle",{defaultValue:"Job title"}),required:!0,error:e.touched.title?e.errors.title:void 0,children:({id:l,describedBy:o,invalid:a})=>(0,i.jsx)(t.pd,{id:l,name:"title",value:e.values.title,onChange:e.handleChange,onBlur:e.handleBlur,placeholder:r("loops.jobTitlePlaceholder",{defaultValue:"Frontend Developer"}),state:a?"error":"default","aria-invalid":a,"aria-describedby":o,disabled:h})}),(0,i.jsx)(k.z,{label:r("loops.company",{defaultValue:"Company"}),required:!0,error:e.touched.company?e.errors.company:void 0,children:({id:l,describedBy:o,invalid:a})=>(0,i.jsx)(t.pd,{id:l,name:"company",value:e.values.company,onChange:e.handleChange,onBlur:e.handleBlur,placeholder:r("loops.companyPlaceholder",{defaultValue:"Acme GmbH"}),state:a?"error":"default","aria-invalid":a,"aria-describedby":o,disabled:h})}),(0,i.jsx)(k.z,{label:r("loops.location",{defaultValue:"Location"}),required:!0,error:e.touched.location?e.errors.location:void 0,children:({id:l,describedBy:o,invalid:a})=>(0,i.jsx)(t.pd,{id:l,name:"location",value:e.values.location,onChange:e.handleChange,onBlur:e.handleBlur,placeholder:r("loops.locationJobPlaceholder",{defaultValue:"Berlin / Remote"}),state:a?"error":"default","aria-invalid":a,"aria-describedby":o,disabled:h})}),(0,i.jsx)(k.z,{label:r("loops.platform",{defaultValue:"Platform"}),required:!0,children:({id:l,describedBy:o})=>(0,i.jsx)("select",{id:l,name:"platform",value:e.values.platform,onChange:l=>{p.current=!0,e.handleChange(l)},onBlur:e.handleBlur,"aria-describedby":o,disabled:h,className:"h-10 w-full rounded-xl border border-border bg-input px-3 text-sm text-foreground",children:B.WI.map(e=>(0,i.jsx)("option",{value:e.value,children:e.label},e.value))})}),(0,i.jsx)(k.z,{label:r("loops.jobUrl",{defaultValue:"Job URL"}),required:!0,hint:r("loops.jobUrlHint",{defaultValue:"You can paste without https:// (it will be normalized on save)."}),error:e.touched.url?e.errors.url:void 0,children:({id:l,describedBy:o,invalid:a})=>(0,i.jsx)(t.pd,{id:l,name:"url",value:e.values.url,onChange:l=>{const o=l.target.value;e.setFieldValue("url",o);const a=function(e){if(!e)return"other";let l="";try{l=new URL(e).host.toLowerCase()}catch{return"other"}for(const e of C)if(l.includes(e.needle))return e.platform;return"other"}(o);!p.current&&a&&e.setFieldValue("platform",a)},onBlur:e.handleBlur,placeholder:r("loops.jobUrlPlaceholder",{defaultValue:"company.com/job"}),state:a?"error":"default","aria-invalid":a,"aria-describedby":o,disabled:h})}),(0,i.jsx)(k.z,{label:r("loops.status",{defaultValue:"Status"}),required:!0,children:({id:l,describedBy:o})=>(0,i.jsx)("select",{id:l,name:"status",value:e.values.status,onChange:e.handleChange,onBlur:e.handleBlur,"aria-describedby":o,disabled:h,className:"h-10 w-full rounded-xl border border-border bg-input px-3 text-sm text-foreground",children:B.YN.map(e=>(0,i.jsx)("option",{value:e.value,children:r(`loops.status.${e.value}`,{defaultValue:e.label})},e.value))})})]}),(0,i.jsx)(k.z,{label:r("loops.description",{defaultValue:"Description"}),required:!0,error:e.touched.description?e.errors.description:void 0,children:({id:l,describedBy:o,invalid:a})=>(0,i.jsx)(t.fs,{id:l,name:"description",value:e.values.description,onChange:e.handleChange,onBlur:e.handleBlur,placeholder:r("loops.descriptionPlaceholder",{defaultValue:"Paste key parts of the job description here…"}),state:a?"error":"default","aria-invalid":a,"aria-describedby":o,disabled:h})}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(t.$n,{type:"submit",variant:"default",shadow:"sm",shape:"lg",disabled:!a,children:h?r("loops.saving",{defaultValue:"Saving..."}):r("loops.saveMatch",{defaultValue:"Save match"})}),(0,i.jsx)(t.$n,{type:"button",variant:"outline",shape:"lg",onClick:()=>l(!1),disabled:h,children:r("loops.cancel",{defaultValue:"Cancel"})})]})]})}})})}function V(e){const l=new Set;for(const o of e)l.add(o);return Array.from(l)}function L({open:e,onOpenChange:l,value:o,disabled:s,onSave:r}){const{t:d}=(0,a.Bd)(),[c,u]=(0,n.useState)(()=>V(o??[])),[p,h]=(0,n.useState)(!1);(0,n.useEffect)(()=>{e&&u(V(o??[]))},[e,o]);const f=(0,n.useMemo)(()=>new Set(c),[c]),x=c.length,g=!s&&!p;return(0,i.jsx)(t.aF,{open:e,onOpenChange:l,title:d("loops.editSources","Edit sources"),description:d("loops.editSourcesDescription","Choose job boards/platforms. This controls which search links are generated."),size:"lg",children:(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[(0,i.jsxs)("div",{className:"text-sm text-muted-foreground",children:[d("loops.selected","Selected"),": "," ",(0,i.jsx)("span",{className:"font-medium text-foreground",children:x})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(t.$n,{variant:"outline",shape:"lg",onClick:()=>u(m.Rx),disabled:s||p,children:d("loops.recommended","Recommended")}),(0,i.jsx)(t.$n,{variant:"outline",shape:"lg",onClick:()=>u(m.VT),disabled:s||p,children:d("loops.selectAll","Select all")})]})]}),(0,i.jsxs)("div",{className:"rounded-2xl border border-border bg-background p-4 space-y-3",children:[(0,i.jsx)("div",{className:"text-sm font-semibold text-foreground",children:d("loops.groups","Groups")}),(0,i.jsx)("div",{className:"flex flex-wrap gap-2",children:m.fd.map(e=>{const l=(0,m.zV)(e.id),o=l.filter(e=>f.has(e)).length,a=o===l.length&&l.length>0;return(0,i.jsxs)("button",{type:"button",onClick:()=>(e=>{const l=(0,m.zV)(e);u(e=>{const o=new Set(e);if(l.every(e=>o.has(e)))for(const e of l)o.delete(e);else for(const e of l)o.add(e);return Array.from(o)})})(e.id),disabled:s||p,className:["inline-flex items-center gap-2 rounded-full border px-3 py-1 text-xs transition-colors",a?"border-primary/50 bg-primary/10 text-foreground":"border-border bg-card text-muted-foreground",s||p?"opacity-50 cursor-not-allowed":"hover:bg-muted/40"].join(" "),children:[(0,i.jsx)("span",{className:"font-medium",children:e.title}),(0,i.jsxs)("span",{className:"text-[11px] text-muted-foreground",children:[o,"/",l.length]})]},e.id)})})]}),(0,i.jsxs)("div",{className:"rounded-2xl border border-border bg-background p-4 space-y-3",children:[(0,i.jsx)("div",{className:"text-sm font-semibold text-foreground",children:d("loops.platforms","Platforms")}),(0,i.jsx)("div",{className:"grid grid-cols-1 gap-2 md:grid-cols-2",children:(b=m.VT,[...b].sort((e,l)=>{const o=m.Jf[e]??e,a=m.Jf[l]??l;return o.localeCompare(a)})).map(e=>{const l=f.has(e),o=m.Jf[e]??e;return(0,i.jsxs)("label",{className:["flex items-center gap-3 rounded-xl border px-3 py-2 text-sm",l?"border-primary/40 bg-primary/5":"border-border bg-card",s||p?"opacity-50 cursor-not-allowed":"hover:bg-muted/30"].join(" "),children:[(0,i.jsx)("input",{type:"checkbox",checked:l,onChange:()=>(e=>{u(l=>{const o=new Set(l);return o.has(e)?o.delete(e):o.add(e),Array.from(o)})})(e),disabled:s||p}),(0,i.jsx)("span",{className:"text-foreground",children:o})]},e)})})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(t.$n,{variant:"default",shadow:"sm",shape:"lg",onClick:async function(){h(!0);try{await r(V(c)),l(!1)}finally{h(!1)}},disabled:!g,children:p?d("loops.saving","Saving..."):d("loops.save","Save")}),(0,i.jsx)(t.$n,{variant:"outline",shape:"lg",onClick:()=>l(!1),disabled:s||p,children:d("loops.cancel","Cancel")})]})]})});var b}const A=[5,10,20,30,50,100],q=[1,3,7,14,30];function K(e){return e.replace(/\s+/g," ").trim()}function P({value:e,onChange:l,onApply:o,onReset:s,disabled:r}){const{t:d}=(0,a.Bd)(),[c,u]=(0,n.useState)(!1),p=(0,n.useMemo)(()=>[{value:"any",label:d("loops.workMode.any","Any")},{value:"onsite",label:d("loops.workMode.onsite","On-site")},{value:"hybrid",label:d("loops.workMode.hybrid","Hybrid")},{value:"remote",label:d("loops.workMode.remote","Remote")},{value:"remote_only",label:d("loops.workMode.remoteOnly","Remote-only")}],[d]),m=(0,n.useMemo)(()=>[{value:"intern",label:d("loops.seniority.intern","Intern")},{value:"junior",label:d("loops.seniority.junior","Junior")},{value:"mid",label:d("loops.seniority.mid","Mid")},{value:"senior",label:d("loops.seniority.senior","Senior")},{value:"lead",label:d("loops.seniority.lead","Lead")}],[d]),h=(0,n.useMemo)(()=>[{value:"full_time",label:d("loops.employment.fullTime","Full-time")},{value:"part_time",label:d("loops.employment.partTime","Part-time")},{value:"contract",label:d("loops.employment.contract","Contract")},{value:"internship",label:d("loops.employment.internship","Internship")},{value:"ausbildung",label:d("loops.employment.ausbildung","Ausbildung")}],[d]),f=(0,n.useMemo)(()=>[{value:"any",label:d("loops.language.any","Any")},{value:"de",label:d("loops.language.de","DE")},{value:"en",label:d("loops.language.en","EN")}],[d]),x=(0,n.useMemo)(()=>{const l=[],o=e.role.trim(),a=e.location.trim();return o&&l.push(d("loops.badgeRole","Role: {{value}}",{value:o})),a&&l.push(d("loops.badgeLoc","Loc: {{value}}",{value:a})),l.push(d("loops.badgeRadius","Radius: {{value}}km",{value:e.radiusKm})),"any"!==e.workMode&&l.push(d("loops.badgeMode","Mode: {{value}}",{value:e.workMode})),l.push(d("loops.badgePosted","Posted: {{value}}d",{value:e.postedWithin})),l},[d,e]);return(0,i.jsxs)("div",{className:"rounded-2xl border border-border bg-card p-6 space-y-4",children:[(0,i.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-base font-semibold text-foreground",children:d("loops.filtersTitle","Filters")}),(0,i.jsx)("div",{className:"mt-1 text-sm text-muted-foreground",children:d("loops.filtersSubtitle","Update → Apply → links refresh & saved to loop.")}),x.length?(0,i.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:x.map(e=>(0,i.jsx)("span",{className:"rounded-full border border-border bg-background px-3 py-1 text-xs text-muted-foreground",children:e},e))}):null]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(t.$n,{variant:"default",shadow:"sm",shape:"lg",onClick:o,disabled:r,children:d("loops.apply","Apply")}),(0,i.jsx)(t.$n,{variant:"outline",shape:"lg",onClick:s,disabled:r,children:d("loops.reset","Reset")})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-12",children:[(0,i.jsx)("div",{className:"md:col-span-5",children:(0,i.jsx)(t.zB,{label:d("loops.professionRole","Profession / Role"),children:(0,i.jsx)(t.pd,{value:e.role,onChange:o=>l({...e,role:o.target.value}),placeholder:d("loops.professionRolePlaceholder","Fachinformatiker OR React Developer"),disabled:r})})}),(0,i.jsx)("div",{className:"md:col-span-4",children:(0,i.jsx)(t.zB,{label:d("loops.location","Location"),children:(0,i.jsx)(t.pd,{value:e.location,onChange:o=>l({...e,location:o.target.value}),placeholder:d("loops.locationPlaceholder","Berlin"),disabled:r})})}),(0,i.jsx)("div",{className:"md:col-span-2",children:(0,i.jsx)(t.zB,{label:d("loops.radius","Radius"),children:(0,i.jsx)("select",{value:e.radiusKm,onChange:o=>l({...e,radiusKm:Number(o.target.value)}),className:"h-10 w-full rounded-xl border border-border bg-input px-3 text-sm text-foreground",disabled:r,children:A.map(e=>(0,i.jsx)("option",{value:e,children:d("loops.km","{{value}} km",{value:e})},e))})})}),(0,i.jsx)("div",{className:"md:col-span-1",children:(0,i.jsx)(t.zB,{label:" ",hint:"",children:(0,i.jsx)(t.$n,{variant:"outline",shape:"lg",className:"w-full",onClick:()=>u(e=>!e),disabled:r,children:c?d("loops.less","Less"):d("loops.more","More")})})})]}),c?(0,i.jsxs)("div",{className:"rounded-2xl border border-border bg-background p-4 space-y-4",children:[(0,i.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-12",children:[(0,i.jsx)("div",{className:"md:col-span-3",children:(0,i.jsx)(t.zB,{label:d("loops.workModeTitle","Work mode"),children:(0,i.jsx)("select",{value:e.workMode,onChange:o=>l({...e,workMode:o.target.value}),className:"h-10 w-full rounded-xl border border-border bg-card px-3 text-sm text-foreground",disabled:r,children:p.map(e=>(0,i.jsx)("option",{value:e.value,children:e.label},e.value))})})}),(0,i.jsx)("div",{className:"md:col-span-3",children:(0,i.jsx)(t.zB,{label:d("loops.seniorityTitle","Seniority"),children:(0,i.jsx)("select",{value:e.seniority,onChange:o=>l({...e,seniority:o.target.value}),className:"h-10 w-full rounded-xl border border-border bg-card px-3 text-sm text-foreground",disabled:r,children:m.map(e=>(0,i.jsx)("option",{value:e.value,children:e.label},e.value))})})}),(0,i.jsx)("div",{className:"md:col-span-3",children:(0,i.jsx)(t.zB,{label:d("loops.employmentType","Employment type"),children:(0,i.jsx)("select",{value:e.employmentType,onChange:o=>l({...e,employmentType:o.target.value}),className:"h-10 w-full rounded-xl border border-border bg-card px-3 text-sm text-foreground",disabled:r,children:h.map(e=>(0,i.jsx)("option",{value:e.value,children:e.label},e.value))})})}),(0,i.jsx)("div",{className:"md:col-span-3",children:(0,i.jsx)(t.zB,{label:d("loops.postedWithin","Posted within"),children:(0,i.jsx)("select",{value:e.postedWithin,onChange:o=>l({...e,postedWithin:Number(o.target.value)}),className:"h-10 w-full rounded-xl border border-border bg-card px-3 text-sm text-foreground",disabled:r,children:q.map(e=>(0,i.jsx)("option",{value:e,children:d("loops.days","{{value}} days",{value:e})},e))})})})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-12",children:[(0,i.jsx)("div",{className:"md:col-span-6",children:(0,i.jsx)(t.zB,{label:d("loops.includeKeywords","Include keywords"),hint:d("loops.includeKeywordsHint","Optional, will be appended to search query"),children:(0,i.jsx)(t.pd,{value:e.includeKeywords,onChange:o=>l({...e,includeKeywords:K(o.target.value)}),placeholder:d("loops.includeKeywordsPlaceholder","react typescript next"),disabled:r})})}),(0,i.jsx)("div",{className:"md:col-span-6",children:(0,i.jsx)(t.zB,{label:d("loops.excludeKeywords","Exclude keywords"),hint:d("loops.excludeKeywordsHint","Optional, will be appended as exclusions"),children:(0,i.jsx)(t.pd,{value:e.excludeKeywords,onChange:o=>l({...e,excludeKeywords:K(o.target.value)}),placeholder:d("loops.excludeKeywordsPlaceholder","senior lead manager zeitarbeit"),disabled:r})})})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-12",children:[(0,i.jsx)("div",{className:"md:col-span-3",children:(0,i.jsx)(t.zB,{label:d("loops.languageTitle","Language"),children:(0,i.jsx)("select",{value:e.language,onChange:o=>l({...e,language:o.target.value}),className:"h-10 w-full rounded-xl border border-border bg-card px-3 text-sm text-foreground",disabled:r,children:f.map(e=>(0,i.jsx)("option",{value:e.value,children:e.label},e.value))})})}),(0,i.jsx)("div",{className:"md:col-span-4 flex items-end",children:(0,i.jsxs)("label",{className:"flex items-center gap-2 text-sm text-foreground",children:[(0,i.jsx)("input",{type:"checkbox",checked:e.excludeAgencies,onChange:o=>l({...e,excludeAgencies:o.target.checked}),disabled:r}),d("loops.excludeAgencies","Exclude agencies / Zeitarbeit")]})}),(0,i.jsx)("div",{className:"md:col-span-5"})]}),(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:d("loops.advancedInfo","Advanced filters are stored in loop.filters. URL builders can be extended later per platform.")})]}):null]})}function $({open:e,onOpenChange:l,value:o,onChange:s,onApply:r,onReset:n,disabled:d}){const{t:c}=(0,a.Bd)();return(0,i.jsx)(t.aF,{open:e,onOpenChange:l,title:c("loops.myLoopSettings","My Loop settings"),description:c("loops.myLoopSettingsDescription","Update filters, click Apply to refresh links and save settings to your loop."),size:"lg",children:(0,i.jsx)(P,{value:o,onChange:s,onApply:r,onReset:n,disabled:d})})}var I=o(61239);function z({platform:e,url:l,isActive:o,onOpen:s,onAdd:r,addDisabled:n}){const{t:d}=(0,a.Bd)(),c=I.Jf[e]??e;return(0,i.jsx)("div",{className:["rounded-2xl border bg-background p-4 space-y-3",o?"border-primary/50 ring-1 ring-primary/30":"border-border"].join(" "),children:(0,i.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,i.jsxs)("div",{className:"min-w-0",children:[(0,i.jsx)("div",{className:"text-sm font-semibold text-foreground truncate",children:c}),(0,i.jsx)("div",{className:"text-xs text-muted-foreground truncate",children:l})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2 shrink-0",children:[(0,i.jsx)(t.$n,{variant:"outline",shape:"lg",onClick:s,children:d("loops.open","Open")}),(0,i.jsx)(t.$n,{variant:"default",shape:"lg",shadow:"sm",onClick:r,disabled:n,children:d("loops.add","Add")})]})]})})}function F(e,l){const o=Object.keys(m.BV);for(const a of o)if(e[a]!==l[a])return!1;return!0}function O(e){return"string"==typeof e&&e.trim().length>0}function T(e,l){const o=e[l],a="number"==typeof o?o:Number(o);return Number.isFinite(a)?a:0}function D({loop:e,userId:l,page:o,onPageChange:s}){const{t:r}=(0,a.Bd)(),[d,c]=(0,p.mk)(),[u,b]=(0,n.useState)(!1),[j,N]=(0,n.useState)(!1),[w,k]=(0,n.useState)(!1),[C,B]=(0,n.useState)(void 0),M={id:e.id,titles:e.titles,location:e.location??null,radiusKm:e.radiusKm??null,platforms:e.platforms,remoteMode:e.remoteMode,filters:e.filters},{draftFilters:S,setDraftFilters:V,applyDraftFilters:A,resetFilters:q,appliedFilters:K,activeLink:P,setActive:I,links:D}=function(e){const l=(0,n.useMemo)(()=>function(e){const l=(()=>{if(!h(e))return{};const l=e.filters;return h(l)?l:e})();return{role:f(l.role,m.BV.role),location:f(l.location,m.BV.location),radiusKm:g(x(l.radiusKm,m.BV.radiusKm),[5,10,20,30,50,100],m.BV.radiusKm),workMode:g(l.workMode,["any","onsite","hybrid","remote","remote_only"],m.BV.workMode),seniority:g(l.seniority,["intern","junior","mid","senior","lead"],m.BV.seniority),employmentType:g(l.employmentType,["full_time","part_time","contract","internship","ausbildung"],m.BV.employmentType),postedWithin:g(x(l.postedWithin,m.BV.postedWithin),[1,3,7,14,30],m.BV.postedWithin),includeKeywords:f(l.includeKeywords,m.BV.includeKeywords),excludeKeywords:f(l.excludeKeywords,m.BV.excludeKeywords),excludeAgencies:(o=l.excludeAgencies,a=m.BV.excludeAgencies,"boolean"==typeof o?o:a),language:g(l.language,["any","de","en"],m.BV.language)};var o,a}(e),[e]),[o,a]=(0,n.useState)(()=>l),[s,r]=(0,n.useState)(()=>l),[t,i]=(0,n.useState)(null),[d,c]=(0,n.useState)(!1);(0,n.useEffect)(()=>{a(l),r(l),i(null),c(!1)},[e.id]),(0,n.useEffect)(()=>{d||(a(e=>F(e,l)?e:l),r(e=>F(e,l)?e:l),i(null))},[l,d]);const u=(0,n.useCallback)(e=>{a(e),c(!F(e,l))},[l]),p=(0,n.useMemo)(()=>{return function(e,l){return e.map(e=>({platform:e,url:(0,m.ad)(e,l)}))}(e.platforms,{role:[[(l=s).role,l.includeKeywords].filter(Boolean).join(" ").trim(),(l.excludeKeywords||"").split(/\s+/g).filter(Boolean).map(e=>e.startsWith("-")?e:`-${e}`).join(" ")].filter(Boolean).join(" ").trim(),location:l.location,radiusKm:Number(l.radiusKm),workMode:"remote_only"===l.workMode?"remote_only":"any"});var l},[e.platforms,s]),b=(0,n.useCallback)(()=>{a(l),r(l),i(null),c(!1)},[l]),v=(0,n.useCallback)(()=>{r(o),i(null),c(!1)},[o]),y=(0,n.useCallback)((e,l)=>{i({platform:e,url:l})},[]);return{draftFilters:o,setDraftFilters:u,appliedFilters:s,applyDraftFilters:v,resetFilters:b,activeLink:t,setActiveLink:i,setActive:y,links:p}}(M),E=c.isLoading,U=Boolean(l)&&!E,_=12,W=Math.max(1,Math.ceil(D.length/_)),Y=Math.max(1,Math.min(W,(0,v.hD)(o))),J=(Y-1)*_,H=(0,n.useMemo)(()=>0===D.length?{from:0,to:0}:{from:J+1,to:Math.min(D.length,J+_)},[D.length,J,_]),G=(0,n.useMemo)(()=>D.slice(J,J+_),[D,J,_]),Z=(0,n.useMemo)(()=>{const e=[],l=K.role.trim(),o=K.location.trim(),a=T(K,"radiusKm"),s=K.workMode,t=T(K,"postedWithin");return O(l)&&e.push(r("loops.badgeRole","Role: {{value}}",{value:l})),O(o)&&e.push(r("loops.badgeLoc","Loc: {{value}}",{value:o})),e.push(r("loops.badgeRadius","Radius: {{value}}km",{value:a})),"any"!==s&&e.push(r("loops.badgeMode","Mode: {{value}}",{value:s})),e.push(r("loops.badgePosted","Posted: {{value}}d",{value:t})),e},[K,r]),X=e=>{B(e),k(!0)};return(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)($,{open:j,onOpenChange:N,value:S,onChange:V,disabled:E,onApply:async()=>{var o;if(A(),s(1),l)try{await d({loopId:e.id,name:e.name,titles:(0,m.CP)(S.role),location:S.location,radiusKm:S.radiusKm,remoteMode:(o=S.workMode,"remote_only"===o?"remote_only":"any"),filters:S}).unwrap(),N(!1)}catch(e){console.error("Failed to save filters:",(0,y.u)(e))}},onReset:()=>{q(),s(1)}}),(0,i.jsxs)("div",{className:"rounded-2xl border border-border bg-card p-4 sm:p-6 space-y-4",children:[(0,i.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between",children:[(0,i.jsxs)("div",{className:"flex min-w-0 flex-col gap-1",children:[(0,i.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,i.jsx)("h3",{className:"text-base font-semibold text-foreground",children:r("loops.searchLinksTitle","Search links")}),(0,i.jsx)("span",{className:"inline-flex items-center rounded-full border border-border bg-muted/40 px-2.5 py-0.5 text-xs font-medium text-muted-foreground",children:r("loops.showing","Showing {{from}}–{{to}} of {{total}}",{from:H.from,to:H.to,total:D.length})})]}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:r("loops.searchLinksSubtitle","Apply filters → open platform → pick a job → paste URL → save match.")}),(0,i.jsxs)("div",{className:"mt-2",children:[(0,i.jsxs)("details",{className:"sm:hidden",children:[(0,i.jsxs)("summary",{className:"cursor-pointer select-none text-sm text-muted-foreground",children:[r("loops.filters","Filters")," (",Z.length,")"]}),Z.length?(0,i.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:Z.map(e=>(0,i.jsx)("span",{className:"rounded-full border border-border bg-background px-3 py-1 text-xs text-muted-foreground",children:e},e))}):(0,i.jsx)("div",{className:"mt-2 text-xs text-muted-foreground",children:r("loops.noFilters","No filters applied")})]}),Z.length?(0,i.jsx)("div",{className:"hidden sm:flex flex-wrap gap-2",children:Z.map(e=>(0,i.jsx)("span",{className:"rounded-full border border-border bg-background px-3 py-1 text-xs text-muted-foreground",children:e},e))}):null]})]}),(0,i.jsxs)("div",{className:"flex w-full flex-col gap-2 sm:w-auto sm:flex-row sm:items-center",children:[(0,i.jsx)(t.$n,{variant:"outline",shape:"lg",onClick:()=>N(!0),disabled:E,className:"w-full sm:w-auto",children:r("loops.myLoopSettings","My Loop settings")}),(0,i.jsx)(t.$n,{variant:"outline",shape:"lg",onClick:()=>b(!0),disabled:!U,className:"w-full sm:w-auto",children:r("loops.editSources","Edit sources")}),(0,i.jsx)(t.$n,{variant:"default",shape:"lg",shadow:"sm",onClick:()=>X(void 0),disabled:!l,className:"w-full sm:w-auto",children:r("loops.addMatch","Add match")})]}),(0,i.jsx)(L,{open:u,onOpenChange:b,value:e.platforms,disabled:!U,onSave:async o=>{if(l)try{await d({loopId:e.id,platforms:o}).unwrap()}catch(e){console.error("Failed to update sources:",(0,y.u)(e))}}})]}),(0,i.jsx)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:G.map(e=>{const o=P?.platform===e.platform&&P?.url===e.url;return(0,i.jsx)(z,{platform:e.platform,url:e.url,isActive:o,onOpen:()=>{return l=e.platform,o=e.url,I(l,o),void function(e){window.open(e,"_blank","noopener,noreferrer")}(o);var l,o},onAdd:()=>X(e.platform),addDisabled:!l},`${e.platform}:${e.url}`)})}),(0,i.jsx)("div",{className:"flex items-center justify-center",children:(0,i.jsx)(t.dK,{page:Y,totalPages:W,onPageChange:s,disabled:E})}),(0,i.jsx)(R,{open:w,onOpenChange:k,loopId:e.id,defaultPlatform:C})]})]})}var E=o(40457),U=o(338);function _({userId:e,loopId:l,onBack:o}){const{t:r}=(0,a.Bd)(),m=(0,s.Zp)(),h=(0,s.zy)(),f=(0,u.j)(),x=(0,u.G)(e=>e.loopsUi.detailsPageByLoopId[l]),g=(e=>{try{const l=new URLSearchParams(e).get("page"),o=l?Number(l):NaN,a=Number.isFinite(o)?Math.trunc(o):NaN;return a>0?a:null}catch{return null}})(h.search),y=g??x??1;(0,n.useEffect)(()=>{null===g&&(0,U.N)(m,h,{page:String(y)},{replace:!0})},[g,y,m,h]),(0,n.useEffect)(()=>{f((0,E.cc)({loopId:l,page:y})),f((0,E.XU)(`${h.pathname}${h.search}`))},[f,l,y,h.pathname,h.search]);const j=(0,p.uB)({loopId:l}),N=j.data??null,w=(0,n.useMemo)(()=>N?.name??r("loops.detailsTitle","Loop"),[N?.name,r]),k=(0,n.useMemo)(()=>{if(!N)return r("loops.detailsHint","Change filters → Apply → links update and filters persist.");const e=b(N.titles)||r("loops.dash","—"),l="remote_only"===N.remoteMode?r("loops.remoteOnly","Remote"):r("loops.any","Any");return`${e} · ${N.location} · ${l}`},[N,r]),C=(0,n.useMemo)(()=>j.isLoading?(0,i.jsx)(c,{children:r("loops.loadingLoop","Loading loop…")}):j.isError?(0,i.jsx)(c,{children:(0,v.u1)(j.error)}):N?(0,i.jsx)(D,{userId:e,page:y,onPageChange:e=>{f((0,E.cc)({loopId:l,page:e})),(0,U.N)(m,h,{page:String(e)},{replace:!0})},loop:{id:N.id,name:N.name,titles:N.titles,location:N.location,radiusKm:N.radiusKm,platforms:N.platforms,remoteMode:N.remoteMode,filters:N.filters}}):(0,i.jsx)(c,{children:r("loops.notFound","Loop not found.")}),[j.isLoading,j.isError,j.error,N,r,e,y,f,l,m,h]);return(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsx)(d,{title:w,subtitle:k,right:(0,i.jsx)(t.$n,{variant:"outline",shape:"lg",onClick:o,children:r("loops.back","Back")})}),C]})}var W=o(29189),Y=o(73431);function J(e,l){const o=new URLSearchParams(e);o.set("page",String((0,v.hD)(l)));const a=o.toString();return a?`?${a}`:""}function H({userId:e,onOpenLoop:l}){const{t:o}=(0,a.Bd)(),r=(0,s.Zp)(),d=(0,s.zy)(),c=(0,u.j)(),m=(0,u.G)(e=>e.loopsUi.listPage),[h,f]=(0,n.useState)(!1),x=(0,n.useMemo)(()=>function(e){const l=new URLSearchParams(e).get("page");if(!l)return null;const o=Number(l);return(0,v.hD)(o)}(d.search)??(0,v.hD)(m),[d.search,m]),g=(0,n.useRef)({1:null}),[y,j]=(0,n.useState)(null),[N]=(0,p.s8)(),w=(0,n.useCallback)(async l=>{if(!e)return void j(null);if(l<=1)return g.current[1]=null,void j(null);const o=g.current;if(void 0===o[l]){void 0===o[1]&&(o[1]=null);for(let e=1;e<l&&void 0!==o[e];e+=1){const l=o[e]??null,a=await N({pageSize:7,cursorId:l}).unwrap();if(o[e+1]=a.nextCursor??null,!a.nextCursor)break}j(o[l]??null)}else j(o[l]??null)},[N,e]);(0,n.useEffect)(()=>{let e=!1;return(async()=>{try{await w(x)}catch{}})().catch(()=>{}),()=>{e=!0}},[x,w]);const k=(0,p.wB)(e?{pageSize:7,cursorId:y}:W.hT),C=k.data,B=(0,n.useMemo)(()=>C?.items??[],[C]),M=C?.total??0,S=k.data?.nextCursor??null,R=(0,n.useMemo)(()=>{const e=Math.ceil(M/7);return e<=0?1:e},[M]);(0,n.useEffect)(()=>{if(!k.data)return;const e=x+1,l=g.current;void 0===l[e]&&(l[e]=S)},[k.data,x,S]),(0,n.useEffect)(()=>{if(!k.data)return;const e=Math.max(1,Math.min(R,x));if(e!==x){const l=J(d.search,e);r({pathname:d.pathname,search:l},{replace:!0})}},[k.data,x,R,r,d.pathname,d.search]),(0,n.useEffect)(()=>{c((0,E.t0)(x)),c((0,E.XU)(`${d.pathname}${d.search}`))},[c,x,d.pathname,d.search]);const V=(0,n.useCallback)(async e=>{const l=(0,v.hD)(e);await w(l);const o=J(d.search,l);r({pathname:d.pathname,search:o},{replace:!1})},[r,d.pathname,d.search,w]),L=(0,n.useMemo)(()=>0===M?0:7*(x-1)+1,[x,M]),A=(0,n.useMemo)(()=>0===M?0:7*(x-1)+B.length,[x,M,B.length]),q=(0,n.useMemo)(()=>k.isLoading?(0,i.jsx)("div",{className:"text-sm text-muted-foreground",children:o("loops.loading","Loading…")}):k.isError?(0,i.jsx)("div",{className:"text-sm text-muted-foreground",children:(0,v.u1)(k.error)}):0===M?(0,i.jsx)("div",{className:"text-sm text-muted-foreground",children:o("loops.empty","No loops yet. Create your first loop.")}):(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)("div",{className:"space-y-3",children:B.map(e=>{const a=b(e.titles)||o("loops.dash","—"),s="remote_only"===e.remoteMode?o("loops.remoteOnly","Remote"):o("loops.any","Any");return(0,i.jsxs)("div",{tabIndex:0,onClick:()=>l(e.id),onKeyDown:o=>{"Enter"!==o.key&&" "!==o.key||(o.preventDefault(),l(e.id))},className:["w-full","rounded-xl border border-border bg-background","px-4 py-4","hover:bg-muted transition-colors","focus:outline-none focus:ring-2 focus:ring-border","cursor-pointer","select-none"].join(" "),children:[(0,i.jsx)("div",{className:"text-sm font-semibold text-foreground",children:e.name}),(0,i.jsxs)("div",{className:"mt-1 text-xs text-muted-foreground",children:[e.location," · ",a," · ",s]})]},e.id)})}),(0,i.jsxs)("div",{className:"grid grid-cols-3 items-center",children:[(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:o("loops.showing","Showing {{from}}–{{to}} of {{total}}",{from:L,to:A,total:M})}),(0,i.jsx)(t.dK,{page:x,totalPages:R,onPageChange:V,disabled:k.isFetching,siblingCount:1})]})]}),[k.isLoading,k.isError,k.error,k.isFetching,B,l,x,L,A,o,M,R,V]);return(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsx)(t.zY,{title:o("loops.listTitle","My Loops"),subtitle:o("loops.listSubtitle","Create a loop and track matches."),right:(0,i.jsx)(t.$n,{variant:"default",shadow:"sm",shape:"lg",onClick:()=>f(!0),children:o("loops.newLoop","New loop")})}),(0,i.jsx)("div",{className:"rounded-2xl border border-border bg-card p-6",children:q}),(0,i.jsx)(Y.Wk,{open:h,onOpenChange:f,onCreated:e=>{g.current={1:null},j(null);const o=J(d.search,1);r({pathname:d.pathname,search:o},{replace:!0}),l(e)}})]})}function G(){const{t:e}=(0,a.Bd)(),{userId:l}=(0,r.gv)(),o=(0,s.Zp)(),n=(0,s.zy)(),{loopId:u}=(0,s.g)(),p=Boolean(u),m=()=>o(`/dashboard/loops${n.search}`);return l?p?(0,i.jsx)(_,{userId:l,loopId:u,onBack:m}):(0,i.jsx)(H,{userId:l,onOpenLoop:e=>o(`/dashboard/loops/${e}${n.search}`)}):(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsx)(d,{title:p?e("loops.detailsTitle","Loop"):e("loops.listTitle","My Loops"),subtitle:e("loops.signInSubtitle","Sign in to continue."),right:p?(0,i.jsx)(t.$n,{variant:"outline",shape:"lg",onClick:m,children:e("loops.back","Back")}):null}),(0,i.jsx)(c,{children:e("loops.signInBody","Please sign in to view your loops.")})]})}}}]);
//# sourceMappingURL=4012.c8d4e921.chunk.js.map