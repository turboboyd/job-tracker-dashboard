"use strict";(self.webpackChunkjob_tracker_dashboard=self.webpackChunkjob_tracker_dashboard||[]).push([[5354],{39819(e,a,t){t.d(a,{Ax:()=>I,EZ:()=>g,GX:()=>p,Kk:()=>n,LJ:()=>f,Rg:()=>u,SP:()=>N,Ss:()=>E,Vl:()=>r,XQ:()=>s,Xu:()=>d,cW:()=>C,i2:()=>o,kF:()=>b,oZ:()=>i,vy:()=>T});const r=["ACTIVE","INTERVIEW","OFFER","HIRED","REJECTED","NO_RESPONSE","ARCHIVED"],s=Object.fromEntries(Object.entries({SAVED:{key:"SAVED",stage:"ACTIVE",labelKey:"status.SAVED",color:"neutral",boardColumn:"ACTIVE",order:10},REVIEWED:{key:"REVIEWED",stage:"ACTIVE",labelKey:"status.REVIEWED",color:"neutral",boardColumn:"ACTIVE",order:20},CV_ADAPTING:{key:"CV_ADAPTING",stage:"ACTIVE",labelKey:"status.CV_ADAPTING",color:"info",boardColumn:"ACTIVE",order:30},COVER_LETTER_WRITING:{key:"COVER_LETTER_WRITING",stage:"ACTIVE",labelKey:"status.COVER_LETTER_WRITING",color:"info",boardColumn:"ACTIVE",order:40},READY_TO_APPLY:{key:"READY_TO_APPLY",stage:"ACTIVE",labelKey:"status.READY_TO_APPLY",color:"info",boardColumn:"ACTIVE",order:50},APPLIED:{key:"APPLIED",stage:"ACTIVE",labelKey:"status.APPLIED",color:"warning",boardColumn:"ACTIVE",order:60},REAPPLIED:{key:"REAPPLIED",stage:"ACTIVE",labelKey:"status.REAPPLIED",color:"warning",boardColumn:"ACTIVE",order:70},WAITING_RESPONSE:{key:"WAITING_RESPONSE",stage:"ACTIVE",labelKey:"status.WAITING_RESPONSE",color:"warning",boardColumn:"ACTIVE",order:80},AUTO_REPLY_RECEIVED:{key:"AUTO_REPLY_RECEIVED",stage:"ACTIVE",labelKey:"status.AUTO_REPLY_RECEIVED",color:"warning",boardColumn:"ACTIVE",order:90},RESPONSE_RECEIVED:{key:"RESPONSE_RECEIVED",stage:"ACTIVE",labelKey:"status.RESPONSE_RECEIVED",color:"info",boardColumn:"ACTIVE",order:100},MORE_INFO_REQUESTED:{key:"MORE_INFO_REQUESTED",stage:"ACTIVE",labelKey:"status.MORE_INFO_REQUESTED",color:"info",boardColumn:"ACTIVE",order:110},FOLLOW_UP_REQUIRED:{key:"FOLLOW_UP_REQUIRED",stage:"ACTIVE",labelKey:"status.FOLLOW_UP_REQUIRED",color:"warning",boardColumn:"ACTIVE",order:120},WONT_APPLY:{key:"WONT_APPLY",stage:"REJECTED",labelKey:"status.WONT_APPLY",color:"danger",boardColumn:"REJECTED",order:900},HR_CALL_SCHEDULED:{key:"HR_CALL_SCHEDULED",stage:"INTERVIEW",labelKey:"status.HR_CALL_SCHEDULED",color:"purple",boardColumn:"INTERVIEW",order:200},HR_PASSED:{key:"HR_PASSED",stage:"INTERVIEW",labelKey:"status.HR_PASSED",color:"purple",boardColumn:"INTERVIEW",order:210},HR_FAILED:{key:"HR_FAILED",stage:"REJECTED",labelKey:"status.HR_FAILED",color:"danger",boardColumn:"REJECTED",order:910},TECH_SCHEDULED:{key:"TECH_SCHEDULED",stage:"INTERVIEW",labelKey:"status.TECH_SCHEDULED",color:"purple",boardColumn:"INTERVIEW",order:220},TECH_PASSED:{key:"TECH_PASSED",stage:"INTERVIEW",labelKey:"status.TECH_PASSED",color:"purple",boardColumn:"INTERVIEW",order:230},TECH_FAILED:{key:"TECH_FAILED",stage:"REJECTED",labelKey:"status.TECH_FAILED",color:"danger",boardColumn:"REJECTED",order:920},FINAL_INTERVIEW:{key:"FINAL_INTERVIEW",stage:"INTERVIEW",labelKey:"status.FINAL_INTERVIEW",color:"purple",boardColumn:"INTERVIEW",order:240},TEST_TASK_RECEIVED:{key:"TEST_TASK_RECEIVED",stage:"INTERVIEW",labelKey:"status.TEST_TASK_RECEIVED",color:"purple",boardColumn:"INTERVIEW",order:250},TEST_TASK_SUBMITTED:{key:"TEST_TASK_SUBMITTED",stage:"INTERVIEW",labelKey:"status.TEST_TASK_SUBMITTED",color:"purple",boardColumn:"INTERVIEW",order:260},WAITING_DECISION:{key:"WAITING_DECISION",stage:"INTERVIEW",labelKey:"status.WAITING_DECISION",color:"purple",boardColumn:"INTERVIEW",order:270},OFFER_RECEIVED:{key:"OFFER_RECEIVED",stage:"OFFER",labelKey:"status.OFFER_RECEIVED",color:"success",boardColumn:"OFFER",order:300},OFFER_REVIEWING:{key:"OFFER_REVIEWING",stage:"OFFER",labelKey:"status.OFFER_REVIEWING",color:"success",boardColumn:"OFFER",order:310},NEGOTIATING:{key:"NEGOTIATING",stage:"OFFER",labelKey:"status.NEGOTIATING",color:"success",boardColumn:"OFFER",order:320},OFFER_ACCEPTED:{key:"OFFER_ACCEPTED",stage:"HIRED",labelKey:"status.OFFER_ACCEPTED",color:"success",boardColumn:"OFFER",order:330},OFFER_DECLINED:{key:"OFFER_DECLINED",stage:"ARCHIVED",labelKey:"status.OFFER_DECLINED",color:"neutral",boardColumn:"REJECTED",order:800},OFFER_RESCINDED:{key:"OFFER_RESCINDED",stage:"REJECTED",labelKey:"status.OFFER_RESCINDED",color:"danger",boardColumn:"REJECTED",order:930},START_PLANNED:{key:"START_PLANNED",stage:"HIRED",labelKey:"status.START_PLANNED",color:"success",boardColumn:"OFFER",order:400},STARTED:{key:"STARTED",stage:"HIRED",labelKey:"status.STARTED",color:"success",boardColumn:"OFFER",order:410},REJECTED_PRE_INTERVIEW:{key:"REJECTED_PRE_INTERVIEW",stage:"REJECTED",labelKey:"status.REJECTED_PRE_INTERVIEW",color:"danger",boardColumn:"REJECTED",order:940},REJECTED_AFTER_INTERVIEW:{key:"REJECTED_AFTER_INTERVIEW",stage:"REJECTED",labelKey:"status.REJECTED_AFTER_INTERVIEW",color:"danger",boardColumn:"REJECTED",order:950},ROLE_CLOSED:{key:"ROLE_CLOSED",stage:"REJECTED",labelKey:"status.ROLE_CLOSED",color:"danger",boardColumn:"REJECTED",order:960},GHOSTING:{key:"GHOSTING",stage:"NO_RESPONSE",labelKey:"status.GHOSTING",color:"danger",boardColumn:"REJECTED",order:970},ARCHIVED_GENERAL:{key:"ARCHIVED_GENERAL",stage:"ARCHIVED",labelKey:"status.ARCHIVED_GENERAL",color:"neutral",boardColumn:"REJECTED",order:980},KEEP_IN_TOUCH:{key:"KEEP_IN_TOUCH",stage:"ARCHIVED",labelKey:"status.KEEP_IN_TOUCH",color:"neutral",boardColumn:"REJECTED",order:990},WITHDREW_BEFORE_START:{key:"WITHDREW_BEFORE_START",stage:"ARCHIVED",labelKey:"status.WITHDREW_BEFORE_START",color:"neutral",boardColumn:"REJECTED",order:995}}).map(([e,a])=>[e,{...a,boardColumn:a.stage}])),o=Object.keys(s),l={ACTIVE:{key:"ACTIVE",labelKey:"board.column.ACTIVE",order:1},INTERVIEW:{key:"INTERVIEW",labelKey:"board.column.INTERVIEW",order:2},OFFER:{key:"OFFER",labelKey:"board.column.OFFER",order:3},HIRED:{key:"HIRED",labelKey:"board.column.HIRED",order:4},REJECTED:{key:"REJECTED",labelKey:"board.column.REJECTED",order:5},NO_RESPONSE:{key:"NO_RESPONSE",labelKey:"board.column.NO_RESPONSE",order:6},ARCHIVED:{key:"ARCHIVED",labelKey:"board.column.ARCHIVED",order:7}},n=r.map(e=>l[e]).sort((e,a)=>e.order-a.order),i={neutral:"bg-muted text-foreground",info:"bg-blue-100 text-blue-900",warning:"bg-amber-100 text-amber-900",success:"bg-emerald-100 text-emerald-900",danger:"bg-red-100 text-red-900",purple:"bg-purple-100 text-purple-900"},E={neutral:"bg-status-neutral",info:"bg-status-info",warning:"bg-status-warning",success:"bg-status-success",danger:"bg-status-danger",purple:"bg-status-purple"},u={neutral:"#64748b",info:"#2563eb",warning:"#d97706",success:"#059669",danger:"#dc2626",purple:"#7c3aed"},c={ACTIVE:"info",INTERVIEW:"purple",OFFER:"warning",HIRED:"success",REJECTED:"danger",NO_RESPONSE:"neutral",ARCHIVED:"neutral"};function d(e){return c[I(e).stage]}const p={ACTIVE:"info",INTERVIEW:"purple",OFFER:"warning",HIRED:"success",REJECTED:"danger",NO_RESPONSE:"neutral",ARCHIVED:"neutral"},g={ACTIVE:u[p.ACTIVE],INTERVIEW:u[p.INTERVIEW],OFFER:u[p.OFFER],HIRED:u[p.HIRED],REJECTED:u[p.REJECTED],NO_RESPONSE:u[p.NO_RESPONSE],ARCHIVED:u[p.ARCHIVED]},R=Object.values(s).sort((e,a)=>e.order-a.order);function C(e){return"string"==typeof e&&e in s}function I(e){return s[e]}function T(e){const a=s[e];return a?.boardColumn??"ACTIVE"}function b(e){return R.filter(a=>a.stage===e)}const m={SAVED:"SAVED",PLANNED:"READY_TO_APPLY",APPLIED:"APPLIED",VIEWED:"RESPONSE_RECEIVED",INTERVIEW_1:"HR_CALL_SCHEDULED",INTERVIEW_2:"TECH_SCHEDULED",TEST_TASK:"TEST_TASK_RECEIVED",OFFER:"OFFER_RECEIVED",REJECTED:"REJECTED_PRE_INTERVIEW",NO_RESPONSE:"GHOSTING"};function y(e){if("string"!=typeof e)return null;const a=e.toUpperCase();return a in m?m[a]:null}function D(e){return e&&"object"==typeof e?e:null}function f(e){if(C(e))return e;const a=y(e);if(a)return a;if("string"==typeof e){const a=e.trim().toUpperCase().replace(/[\s-]+/g,"_");if(C(a))return a;if(r.includes(a))return function(e){const a=R.filter(a=>a.boardColumn===e).sort((e,a)=>e.order-a.order)[0];return a?.key??"SAVED"}(a)}return null}const N=function(e){const a=D(e),t=D(a?.process),r=t?.stage,o=t?.subStatus;if("string"==typeof r&&"string"==typeof o&&C(o))return{stage:s[o].stage,subStatus:o,changed:r!==s[o].stage};const l=y(t?.status);return l?{stage:s[l].stage,subStatus:l,changed:!0}:{stage:"ACTIVE",subStatus:"SAVED",changed:!0}}},51728(e,a,t){t.d(a,{w:()=>s});var r=t(67167);function s(e){return{ensureUserDoc:a=>(0,r.Ag)(e,a),createApplication:(a,t)=>(0,r.tM)(e,a,t),queryPipelineByStatus:(a,t,s)=>(0,r.Ms)(e,a,t,s),queryAllActiveApplications:(a,t)=>(0,r.De)(e,a,t),queryTodayTopPriority:(a,t)=>(0,r.Fr)(e,a,t),getApplicationHistory:(a,t,s)=>(0,r.b7)(e,a,t,s),queryFollowUpsDue:(a,t)=>(0,r.mx)(e,a,t),autoMarkGhosting:(a,t)=>(0,r.C9)(e,a,t,30)}}},61300(e,a,t){t.d(a,{md:()=>u,VX:()=>n,Wq:()=>p});var r=t(96540),s=t(22022),o=t(39819),l=t(74848);function n({status:e,fallback:a}){const{t}=(0,s.Bd)(),r=(0,o.Ax)(e),n=a??r.key.split("_").map(e=>e?e[0].toUpperCase()+e.slice(1).toLowerCase():e).join(" ");return(0,l.jsx)(l.Fragment,{children:t(r.labelKey,{defaultValue:n})})}function i(...e){return e.filter(Boolean).join(" ")}const E={xs:"h-1.5 w-1.5",sm:"h-2 w-2",md:"h-2.5 w-2.5"};function u({status:e,className:a,size:t="sm"}){const r=(0,o.Xu)(e);return(0,l.jsx)("span",{"aria-hidden":!0,className:i("inline-block rounded-full",E[t],o.Ss[r],a)})}function c(...e){return e.filter(Boolean).join(" ")}const d={sm:"h-9 px-sm text-sm",md:"h-10 px-md text-sm"};function p({value:e,onChange:a,disabled:t=!1,stage:s,options:i,className:E,size:u="sm"}){const p=(0,r.useMemo)(()=>i?.length?i:s?(0,o.kF)(s).map(e=>e.key):o.i2,[i,s]);return(0,l.jsx)("select",{value:e,disabled:t,onChange:e=>a(e.target.value),className:c("rounded-full border border-border bg-card text-foreground focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background",d[u],E),children:p.map(e=>(0,l.jsx)("option",{value:e,children:(0,l.jsx)(n,{status:e})},e))})}},65354(e,a,t){t.r(a),t.d(a,{default:()=>f});var r=t(96540),s=t(51175),o=t(96788),l=t(51728);const n={companyName:"",roleTitle:"",vacancyUrl:"",source:"",rawDescription:""},i=[{key:"all",status:"ALL"},{key:"saved",status:"SAVED"},{key:"applied",status:"APPLIED"},{key:"interview",status:"INTERVIEW_1"},{key:"offer",status:"OFFER"},{key:"rejected",status:"REJECTED"}];var E=t(22022),u=t(46681),c=t(3433),d=t(39819),p=t(61300),g=t(74848);function R(e){const{row:a}=e,{t}=(0,E.Bd)(),r=(0,c.Zp)();return(0,g.jsxs)("button",{type:"button",onClick:()=>r(`/dashboard/applications/${a.id}`),className:"w-full py-sm flex items-center gap-md text-left hover:bg-muted/40 rounded-md px-2",children:[(0,g.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,g.jsx)("div",{className:"truncate text-sm font-medium text-foreground",children:a.data.job.roleTitle}),(0,g.jsxs)("div",{className:"truncate text-xs text-muted-foreground",children:[a.data.job.companyName,a.data.job.source?` • ${a.data.job.source}`:""]}),a.data.matching?(0,g.jsxs)("div",{className:"mt-1 text-[11px] text-muted-foreground",children:[t("applicationsPage.matching",{defaultValue:"Match",returnObjects:!1})??"Match",": ",a.data.matching.score,"/100 • ",a.data.matching.decision]}):null]}),(0,g.jsxs)("div",{className:"flex items-center gap-sm shrink-0",children:[a.data.process.needsFollowUp?(0,g.jsx)("span",{className:"rounded-full border border-border bg-background px-2 py-1 text-[11px] font-medium text-foreground",children:t("applicationsPage.followUpBadge",{defaultValue:"Follow-up",returnObjects:!1})??"Follow-up"}):null,(()=>{const e=(0,d.LJ)(a.data.process.status);return(0,g.jsxs)("div",{className:"flex items-center gap-2 rounded-full border border-border bg-background px-sm py-1 text-[11px] font-medium text-foreground",children:[e?(0,g.jsx)(p.md,{status:e}):null,(0,g.jsx)("span",{className:"text-foreground",children:e?(0,g.jsx)(p.VX,{status:e,fallback:String(a.data.process.status)}):String(a.data.process.status)})]})})()]})]})}function C(e){const{t:a}=(0,E.Bd)(),{list:t,view:r}=e;let s;return s="today"===r?a("applicationsPage.empty.today",{defaultValue:"Nothing for today.",returnObjects:!1})??"Nothing for today.":"followups"===r?a("applicationsPage.empty.followups",{defaultValue:"No follow-ups due.",returnObjects:!1})??"No follow-ups due.":a("applicationsPage.empty.pipeline",{defaultValue:"No applications yet.",returnObjects:!1})??"No applications yet.",(0,g.jsx)(u.Zp,{padding:"md",shadow:"sm",className:"space-y-sm",children:0===t.length?(0,g.jsx)("div",{className:"text-sm text-muted-foreground",children:s}):(0,g.jsx)("div",{className:"divide-y divide-border",children:t.map(e=>(0,g.jsx)("div",{className:"py-[2px]",children:(0,g.jsx)(R,{row:e})},e.id))})})}function I(e){const{t:a}=(0,E.Bd)(),{value:t,onChange:r}=e;return(0,g.jsxs)("div",{className:"flex items-center gap-sm",children:[(0,g.jsx)(u.$n,{size:"sm",variant:"pipeline"===t?"default":"outline",onClick:()=>r("pipeline"),children:a("applicationsPage.views.pipeline",{defaultValue:"Pipeline",returnObjects:!1})??"Pipeline"}),(0,g.jsx)(u.$n,{size:"sm",variant:"today"===t?"default":"outline",onClick:()=>r("today"),children:a("applicationsPage.views.today",{defaultValue:"Today",returnObjects:!1})??"Today"}),(0,g.jsx)(u.$n,{size:"sm",variant:"followups"===t?"default":"outline",onClick:()=>r("followups"),children:a("applicationsPage.views.followups",{defaultValue:"Follow-ups",returnObjects:!1})??"Follow-ups"})]})}function T(e){const{view:a,onChangeView:t}=e,{t:r}=(0,E.Bd)();return(0,g.jsxs)("div",{className:"flex items-start justify-between gap-md",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{className:"text-xl font-semibold text-foreground",children:r("applicationsPage.title",{defaultValue:"My applications",returnObjects:!1})??"My applications"}),(0,g.jsx)("div",{className:"text-sm text-muted-foreground",children:r("applicationsPage.subtitle","Create and track your job applications in one place.")})]}),(0,g.jsx)(I,{value:a,onChange:t})]})}function b(e){const{t:a}=(0,E.Bd)(),{activeStatus:t,onChange:r,isLoading:s,count:o}=e;return(0,g.jsx)("div",{className:"space-y-sm",children:(0,g.jsxs)("div",{className:"flex flex-wrap items-center gap-sm",children:[i.map(e=>{const s=a("ALL"===(o=e.status)?"applicationsPage.pipeline.all":`applicationsPage.statuses.${o.toLowerCase()}`,{defaultValue:String(e.status),returnObjects:!1})??String(e.status);var o;const l=a(`applicationsPage.pipeline.${e.key}`,{defaultValue:s,returnObjects:!1})??s,n="ALL"===e.status?null:(0,d.LJ)(e.status);return(0,g.jsx)(u.$n,{variant:t===e.status?"default":"outline",size:"sm",onClick:()=>r(e.status),children:(0,g.jsxs)("span",{className:"inline-flex items-center gap-2",children:[n?(0,g.jsx)(p.md,{status:n}):null,(0,g.jsx)("span",{children:l})]})},e.key)}),(0,g.jsx)("div",{className:"ml-auto text-xs text-muted-foreground",children:s?a("applicationsPage.pipeline.loading",{defaultValue:"Loading…",returnObjects:!1})??"Loading…":a("applicationsPage.pipeline.count",{defaultValue:"Count: {{count}}",count:o,returnObjects:!1})??`Count: ${o}`})]})})}function m(e){const{t:a}=(0,E.Bd)(),{view:t,isLoading:r,count:s}=e;return(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsx)("div",{className:"text-xs text-muted-foreground",children:"today"===t?a("applicationsPage.todayHint",{defaultValue:"Sorted by priority.score",returnObjects:!1})??"Sorted by priority.score":a("applicationsPage.followupsHint","Needs follow-up ordered by due date")}),(0,g.jsx)("div",{className:"text-xs text-muted-foreground",children:r?a("applicationsPage.pipeline.loading",{defaultValue:"Loading…",returnObjects:!1})??"Loading…":a("applicationsPage.pipeline.count",{defaultValue:"Count: {{count}}",returnObjects:!1,count:s})??"Count: {{count}}"})]})}function y(e){const{view:a,activeStatus:t,onChangeStatus:r,isLoading:s,count:o}=e;return"pipeline"===a?(0,g.jsx)(b,{activeStatus:t,onChange:r,isLoading:s,count:o}):(0,g.jsx)(m,{view:a,isLoading:s,count:o})}function D(e){const{t:a}=(0,E.Bd)(),{form:t,onChange:r,onCreate:s,canSubmit:o,isCreating:l}=e;return(0,g.jsxs)("div",{className:"rounded-2xl border p-4 shadow-sm",children:[(0,g.jsx)("div",{className:"mb-3 text-lg font-semibold",children:a("applicationsPage.create.title",{defaultValue:"New application",returnObjects:!1})??"New application"}),(0,g.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[(0,g.jsx)(u.zB,{label:a("applicationsPage.create.company",{defaultValue:"Company",returnObjects:!1})??"Company",required:!0,children:e=>(0,g.jsx)(u.pd,{id:e.id,"aria-describedby":e.describedBy,"aria-invalid":e.invalid,value:t.companyName,onChange:e=>r("companyName",e.target.value),placeholder:a("applicationsPage.create.companyPh",{defaultValue:"e.g. ACME GmbH",returnObjects:!1})??"e.g. ACME GmbH"})}),(0,g.jsx)(u.zB,{label:a("applicationsPage.create.role",{defaultValue:"Role",returnObjects:!1})??"Role",required:!0,children:e=>(0,g.jsx)(u.pd,{id:e.id,"aria-describedby":e.describedBy,"aria-invalid":e.invalid,value:t.roleTitle,onChange:e=>r("roleTitle",e.target.value),placeholder:a("applicationsPage.create.rolePh","e.g. Frontend Developer")})}),(0,g.jsx)("div",{className:"md:col-span-2",children:(0,g.jsx)(u.zB,{label:a("applicationsPage.create.url",{defaultValue:"Vacancy URL",returnObjects:!1})??"Vacancy URL",children:e=>(0,g.jsx)(u.pd,{id:e.id,"aria-describedby":e.describedBy,"aria-invalid":e.invalid,value:t.vacancyUrl,onChange:e=>r("vacancyUrl",e.target.value),placeholder:a("applicationsPage.create.urlPh",{defaultValue:"https://…",returnObjects:!1})??"https://…"})})}),(0,g.jsx)(u.zB,{label:a("applicationsPage.create.source",{defaultValue:"Source",returnObjects:!1})??"Source",children:e=>(0,g.jsx)(u.pd,{id:e.id,"aria-describedby":e.describedBy,"aria-invalid":e.invalid,value:t.source,onChange:e=>r("source",e.target.value),placeholder:a("applicationsPage.create.sourcePh","LinkedIn / Indeed / Company site")})}),(0,g.jsx)("div",{className:"md:col-span-2",children:(0,g.jsx)(u.zB,{label:a("applicationsPage.create.desc",{defaultValue:"Description (optional)",returnObjects:!1})??"Description (optional)",children:e=>(0,g.jsx)(u.fs,{id:e.id,"aria-describedby":e.describedBy,"aria-invalid":e.invalid,value:t.rawDescription,onChange:e=>r("rawDescription",e.target.value),placeholder:a("applicationsPage.create.descPh","Paste vacancy text to improve matching…")})})})]}),(0,g.jsx)("div",{className:"mt-4 flex items-center justify-end gap-2",children:(0,g.jsx)(u.$n,{onClick:s,disabled:!o||l,children:l?a("applicationsPage.create.creating",{defaultValue:"Creating…",returnObjects:!1})??"Creating…":a("applicationsPage.create.createBtn",{defaultValue:"Create",returnObjects:!1})??"Create"})})]})}function f(){const{userId:e,isAuthReady:a}=(0,s.g)(),t=(0,r.useMemo)(()=>(0,l.w)(o.db),[]),{view:i,setView:E,activeStatus:u,setActiveStatus:c,form:d,updateForm:p,canSubmit:R,isCreating:I,onCreate:b,list:m,isLoadingList:f,error:N}=function(e){const{userId:a,isAuthReady:t,repo:s}=e,[o,l]=(0,r.useState)("pipeline"),[i,E]=(0,r.useState)("ALL"),[u,c]=(0,r.useState)(n),[d,p]=(0,r.useState)(!1),[g,R]=(0,r.useState)(!1),[C,I]=(0,r.useState)(!1),[T,b]=(0,r.useState)([]),[m,y]=(0,r.useState)(null),D=(0,r.useMemo)(()=>u.companyName.trim().length>0&&u.roleTitle.trim().length>0,[u.companyName,u.roleTitle]);(0,r.useEffect)(()=>{if(!t||!a)return;let e=!1;return(async()=>{try{p(!0),await s.ensureUserDoc(a)}catch(a){const t=a instanceof Error?a.message:String(a);e||y(t)}finally{e||p(!1)}})(),()=>{e=!0}},[s,t,a]);const f=(0,r.useCallback)(async()=>{if(a){I(!0),y(null);try{if("pipeline"===o){if("ALL"===i){const e=await s.queryAllActiveApplications(a,500);if(await s.autoMarkGhosting(a,e)>0){const e=await s.queryAllActiveApplications(a,500);b(e)}else b(e);return}const e=await s.queryPipelineByStatus(a,i,50);if(await s.autoMarkGhosting(a,e)>0){const e=await s.queryPipelineByStatus(a,i,50);b(e)}else b(e);return}if("today"===o){const e=await s.queryTodayTopPriority(a,50);if(await s.autoMarkGhosting(a,e)>0){const e=await s.queryTodayTopPriority(a,50);b(e)}else b(e);return}const e=await s.queryFollowUpsDue(a,50);if(await s.autoMarkGhosting(a,e)>0){const e=await s.queryFollowUpsDue(a,50);b(e)}else b(e)}catch(e){const a=e instanceof Error?e.message:String(e);y(a)}finally{I(!1)}}},[s,i,a,o]);(0,r.useEffect)(()=>{t&&a&&f()},[t,a,f]);const N=(0,r.useCallback)((e,a)=>{c(t=>({...t,[e]:a}))},[]),A=(0,r.useCallback)(()=>c(n),[]),_=(0,r.useCallback)(async()=>{if(a&&D){R(!0),y(null);try{await s.createApplication(a,{companyName:u.companyName.trim(),roleTitle:u.roleTitle.trim(),vacancyUrl:u.vacancyUrl.trim().length?u.vacancyUrl.trim():void 0,source:u.source.trim().length?u.source.trim():void 0,status:"SAVED",rawDescription:u.rawDescription.trim().length?u.rawDescription.trim():void 0}),A(),l("pipeline"),E("ALL"),await f()}catch(e){const a=e instanceof Error?e.message:String(e);y(a)}finally{R(!1)}}},[s,a,D,u,A,f]);return{view:o,setView:l,activeStatus:i,setActiveStatus:E,form:u,updateForm:N,resetForm:A,canSubmit:D,onCreate:_,list:T,load:f,isEnsuringUser:d,isCreating:g,isLoadingList:C,error:m,setError:y}}({userId:e,isAuthReady:a,repo:t});return(0,g.jsxs)("div",{className:"w-full p-4",children:[(0,g.jsx)(T,{view:i,onChangeView:E}),(0,g.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,g.jsx)(y,{view:i,activeStatus:u,onChangeStatus:c,isLoading:f,count:m.length}),(0,g.jsx)(D,{form:d,onChange:p,onCreate:b,canSubmit:R,isCreating:I}),N?(0,g.jsx)("div",{className:"rounded-xl border border-destructive/30 bg-destructive/5 p-3 text-sm text-destructive",children:N}):null,(0,g.jsx)(C,{list:m,view:i})]})]})}}}]);
//# sourceMappingURL=5354.a1876d56.chunk.js.map