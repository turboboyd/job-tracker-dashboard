"use strict";(self.webpackChunkjob_tracker_dashboard=self.webpackChunkjob_tracker_dashboard||[]).push([[5019],{15019(e,t,E){E.d(t,{_H:()=>y,Xk:()=>g,g5:()=>i,$V:()=>S,LC:()=>_});var o=E(24589),a=E(39819),r=E(67167),s=E(80784),n=E(57616),l=E(42472),u=E(96788);function I(e){return e instanceof Error?e.message:String(e)}function c(e){return{error:{message:e}}}function R(e){const t=String(e??"").trim();return t?/^https?:\/\//i.test(t)?t:`https://${t}`:""}function T(e){switch(a.XQ[e].stage){case"ACTIVE":return"APPLIED";case"INTERVIEW":return"INTERVIEW_1";case"OFFER":case"HIRED":return"OFFER";case"REJECTED":return"REJECTED";case"NO_RESPONSE":return"NO_RESPONSE";default:return"SAVED"}}function d(e){return e?e instanceof o.Dc?e.toDate().toISOString():e instanceof Date?e.toISOString():"number"==typeof e?new Date(e).toISOString():function(e){const t=e&&"object"==typeof e?e:null;return"function"==typeof t?.toDate}(e)?e.toDate().toISOString():"":""}function C(e,t){const E=d(t.loopLinkage?.matchedAt)||d(t.createdAt)||(new Date).toISOString(),o=d(t.createdAt)||E,r=d(t.updatedAt)||o,s=(0,a.SP)(t);return{id:e,loopId:t.loopLinkage?.loopId??"",title:t.job.roleTitle,company:t.job.companyName,location:t.job.locationText??"",platform:"string"==typeof t.loopLinkage?.platform&&t.loopLinkage.platform||"string"==typeof t.job?.source&&t.job.source||"",url:t.job.vacancyUrl??"",description:t.vacancy?.rawDescription??"",status:s.subStatus,matchedAt:E,createdAt:o,updatedAt:r}}const D=n.q.injectEndpoints({endpoints:e=>({getAllMatches:e.query({async queryFn(e,t){try{const e=(0,l.j)(t.getState()),E=(await(0,o.GG)((0,o.P)((0,s.tw)(e)))).docs.map(e=>({id:e.id,app:e.data()})).filter(e=>Boolean(e.app.loopLinkage?.loopId)).map(e=>C(e.id,e.app));return E.sort((e,t)=>(t.matchedAt||"").localeCompare(e.matchedAt||"")),{data:E}}catch(e){return c(I(e))}},providesTags:e=>e?[...e.map(e=>({type:"LoopMatches",id:e.id})),{type:"LoopMatches",id:"LIST:ALL"}]:[{type:"LoopMatches",id:"LIST:ALL"}]}),getMatchesByLoop:e.query({async queryFn({loopId:e},t){try{const E=(0,l.j)(t.getState()),a=(await(0,o.GG)((0,o.P)((0,s.tw)(E),(0,o._M)("loopLinkage.loopId","==",e)))).docs.map(e=>C(e.id,e.data()));return a.sort((e,t)=>(t.matchedAt||"").localeCompare(e.matchedAt||"")),{data:a}}catch(e){return c(I(e))}},providesTags:(e,t,E)=>[{type:"LoopMatches",id:`LIST:LOOP:${E.loopId}`}]}),getMatch:e.query({async queryFn({matchId:e},t){try{const E=(0,l.j)(t.getState()),a=await(0,o.x7)((0,s.mL)(E,e));return a.exists()?{data:C(a.id,a.data())}:{data:null}}catch(e){return c(I(e))}},providesTags:(e,t,E)=>[{type:"LoopMatches",id:E.matchId}]}),createMatch:e.mutation({async queryFn(e,t){try{const E=(0,l.j)(t.getState());return{data:{id:await(0,r.tM)(u.db,E,{companyName:e.company,roleTitle:e.title,locationText:e.location,vacancyUrl:R(e.url),source:String(e.platform??"").toLowerCase(),rawDescription:e.description,status:T(e.status),loopId:e.loopId,loopPlatform:String(e.platform??"").toLowerCase(),loopMatchedAt:e.matchedAt?new Date(e.matchedAt):void 0,loopSource:"loop"})}}}catch(e){return c(I(e))}},invalidatesTags:(e,t,E)=>[{type:"LoopMatches",id:"LIST:ALL"},{type:"LoopMatches",id:`LIST:LOOP:${E.loopId}`}]}),updateMatchStatus:e.mutation({async queryFn({matchId:e,status:t},E){try{const o=(0,l.j)(E.getState());return await(0,r.zQ)(u.db,o,e,T(t)),{data:void 0}}catch(e){return c(I(e))}},invalidatesTags:(e,t,E)=>[{type:"LoopMatches",id:E.matchId},{type:"LoopMatches",id:"LIST:ALL"},{type:"LoopMatches",id:`LIST:LOOP:${E.loopId}`}]}),updateMatch:e.mutation({async queryFn({matchId:e,patch:t},E){try{const a=(0,l.j)(E.getState()),s=function(e){const t={...e};return"string"==typeof t.url&&(t.url=R(t.url)),t}(t),n={};return"string"==typeof s.title&&(n["job.roleTitle"]=s.title),"string"==typeof s.company&&(n["job.companyName"]=s.company),"string"==typeof s.location&&(n["job.locationText"]=s.location),"string"==typeof s.url&&(n["job.vacancyUrl"]=s.url),"string"==typeof s.platform&&(n["loopLinkage.platform"]=s.platform,n["job.source"]=s.platform),"string"==typeof s.description&&(n["vacancy.rawDescription"]=s.description),"string"==typeof s.matchedAt&&s.matchedAt.trim()&&(n["loopLinkage.matchedAt"]=o.Dc.fromDate(new Date(s.matchedAt))),"string"==typeof s.status&&(n["process.status"]=T(s.status),n["process.lastStatusChangeAt"]=o.Dc.fromDate(new Date)),await(0,r.m1)(u.db,a,e,n,()=>[{actor:"user",type:"FIELD_CHANGE",fieldPath:"legacy.loopMatch",oldValue:null,newValue:s}]),{data:void 0}}catch(e){return c(I(e))}},invalidatesTags:(e,t,E)=>[{type:"LoopMatches",id:E.matchId},{type:"LoopMatches",id:"LIST:ALL"}]}),deleteMatch:e.mutation({async queryFn({matchId:e},t){try{const E=(0,l.j)(t.getState());return await(0,o.kd)((0,s.mL)(E,e)),{data:void 0}}catch(e){return c(I(e))}},invalidatesTags:(e,t,E)=>[{type:"LoopMatches",id:E.matchId},{type:"LoopMatches",id:"LIST:ALL"},{type:"LoopMatches",id:`LIST:LOOP:${E.loopId}`}]})})}),{useGetAllMatchesQuery:i,useGetMatchesByLoopQuery:A,useGetMatchQuery:p,useCreateMatchMutation:y,useUpdateMatchStatusMutation:_,useUpdateMatchMutation:S,useDeleteMatchMutation:g}=D;E(65546)},39819(e,t,E){E.d(t,{Ax:()=>i,EZ:()=>d,GX:()=>T,Kk:()=>n,LJ:()=>g,Rg:()=>I,SP:()=>b,Ss:()=>u,Vl:()=>o,XQ:()=>a,Xu:()=>R,cW:()=>D,i2:()=>r,kF:()=>p,oZ:()=>l,vy:()=>A});const o=["ACTIVE","INTERVIEW","OFFER","HIRED","REJECTED","NO_RESPONSE","ARCHIVED"],a=Object.fromEntries(Object.entries({SAVED:{key:"SAVED",stage:"ACTIVE",labelKey:"status.SAVED",color:"neutral",boardColumn:"ACTIVE",order:10},REVIEWED:{key:"REVIEWED",stage:"ACTIVE",labelKey:"status.REVIEWED",color:"neutral",boardColumn:"ACTIVE",order:20},CV_ADAPTING:{key:"CV_ADAPTING",stage:"ACTIVE",labelKey:"status.CV_ADAPTING",color:"info",boardColumn:"ACTIVE",order:30},COVER_LETTER_WRITING:{key:"COVER_LETTER_WRITING",stage:"ACTIVE",labelKey:"status.COVER_LETTER_WRITING",color:"info",boardColumn:"ACTIVE",order:40},READY_TO_APPLY:{key:"READY_TO_APPLY",stage:"ACTIVE",labelKey:"status.READY_TO_APPLY",color:"info",boardColumn:"ACTIVE",order:50},APPLIED:{key:"APPLIED",stage:"ACTIVE",labelKey:"status.APPLIED",color:"warning",boardColumn:"ACTIVE",order:60},REAPPLIED:{key:"REAPPLIED",stage:"ACTIVE",labelKey:"status.REAPPLIED",color:"warning",boardColumn:"ACTIVE",order:70},WAITING_RESPONSE:{key:"WAITING_RESPONSE",stage:"ACTIVE",labelKey:"status.WAITING_RESPONSE",color:"warning",boardColumn:"ACTIVE",order:80},AUTO_REPLY_RECEIVED:{key:"AUTO_REPLY_RECEIVED",stage:"ACTIVE",labelKey:"status.AUTO_REPLY_RECEIVED",color:"warning",boardColumn:"ACTIVE",order:90},RESPONSE_RECEIVED:{key:"RESPONSE_RECEIVED",stage:"ACTIVE",labelKey:"status.RESPONSE_RECEIVED",color:"info",boardColumn:"ACTIVE",order:100},MORE_INFO_REQUESTED:{key:"MORE_INFO_REQUESTED",stage:"ACTIVE",labelKey:"status.MORE_INFO_REQUESTED",color:"info",boardColumn:"ACTIVE",order:110},FOLLOW_UP_REQUIRED:{key:"FOLLOW_UP_REQUIRED",stage:"ACTIVE",labelKey:"status.FOLLOW_UP_REQUIRED",color:"warning",boardColumn:"ACTIVE",order:120},WONT_APPLY:{key:"WONT_APPLY",stage:"REJECTED",labelKey:"status.WONT_APPLY",color:"danger",boardColumn:"REJECTED",order:900},HR_CALL_SCHEDULED:{key:"HR_CALL_SCHEDULED",stage:"INTERVIEW",labelKey:"status.HR_CALL_SCHEDULED",color:"purple",boardColumn:"INTERVIEW",order:200},HR_PASSED:{key:"HR_PASSED",stage:"INTERVIEW",labelKey:"status.HR_PASSED",color:"purple",boardColumn:"INTERVIEW",order:210},HR_FAILED:{key:"HR_FAILED",stage:"REJECTED",labelKey:"status.HR_FAILED",color:"danger",boardColumn:"REJECTED",order:910},TECH_SCHEDULED:{key:"TECH_SCHEDULED",stage:"INTERVIEW",labelKey:"status.TECH_SCHEDULED",color:"purple",boardColumn:"INTERVIEW",order:220},TECH_PASSED:{key:"TECH_PASSED",stage:"INTERVIEW",labelKey:"status.TECH_PASSED",color:"purple",boardColumn:"INTERVIEW",order:230},TECH_FAILED:{key:"TECH_FAILED",stage:"REJECTED",labelKey:"status.TECH_FAILED",color:"danger",boardColumn:"REJECTED",order:920},FINAL_INTERVIEW:{key:"FINAL_INTERVIEW",stage:"INTERVIEW",labelKey:"status.FINAL_INTERVIEW",color:"purple",boardColumn:"INTERVIEW",order:240},TEST_TASK_RECEIVED:{key:"TEST_TASK_RECEIVED",stage:"INTERVIEW",labelKey:"status.TEST_TASK_RECEIVED",color:"purple",boardColumn:"INTERVIEW",order:250},TEST_TASK_SUBMITTED:{key:"TEST_TASK_SUBMITTED",stage:"INTERVIEW",labelKey:"status.TEST_TASK_SUBMITTED",color:"purple",boardColumn:"INTERVIEW",order:260},WAITING_DECISION:{key:"WAITING_DECISION",stage:"INTERVIEW",labelKey:"status.WAITING_DECISION",color:"purple",boardColumn:"INTERVIEW",order:270},OFFER_RECEIVED:{key:"OFFER_RECEIVED",stage:"OFFER",labelKey:"status.OFFER_RECEIVED",color:"success",boardColumn:"OFFER",order:300},OFFER_REVIEWING:{key:"OFFER_REVIEWING",stage:"OFFER",labelKey:"status.OFFER_REVIEWING",color:"success",boardColumn:"OFFER",order:310},NEGOTIATING:{key:"NEGOTIATING",stage:"OFFER",labelKey:"status.NEGOTIATING",color:"success",boardColumn:"OFFER",order:320},OFFER_ACCEPTED:{key:"OFFER_ACCEPTED",stage:"HIRED",labelKey:"status.OFFER_ACCEPTED",color:"success",boardColumn:"OFFER",order:330},OFFER_DECLINED:{key:"OFFER_DECLINED",stage:"ARCHIVED",labelKey:"status.OFFER_DECLINED",color:"neutral",boardColumn:"REJECTED",order:800},OFFER_RESCINDED:{key:"OFFER_RESCINDED",stage:"REJECTED",labelKey:"status.OFFER_RESCINDED",color:"danger",boardColumn:"REJECTED",order:930},START_PLANNED:{key:"START_PLANNED",stage:"HIRED",labelKey:"status.START_PLANNED",color:"success",boardColumn:"OFFER",order:400},STARTED:{key:"STARTED",stage:"HIRED",labelKey:"status.STARTED",color:"success",boardColumn:"OFFER",order:410},REJECTED_PRE_INTERVIEW:{key:"REJECTED_PRE_INTERVIEW",stage:"REJECTED",labelKey:"status.REJECTED_PRE_INTERVIEW",color:"danger",boardColumn:"REJECTED",order:940},REJECTED_AFTER_INTERVIEW:{key:"REJECTED_AFTER_INTERVIEW",stage:"REJECTED",labelKey:"status.REJECTED_AFTER_INTERVIEW",color:"danger",boardColumn:"REJECTED",order:950},ROLE_CLOSED:{key:"ROLE_CLOSED",stage:"REJECTED",labelKey:"status.ROLE_CLOSED",color:"danger",boardColumn:"REJECTED",order:960},GHOSTING:{key:"GHOSTING",stage:"NO_RESPONSE",labelKey:"status.GHOSTING",color:"danger",boardColumn:"REJECTED",order:970},ARCHIVED_GENERAL:{key:"ARCHIVED_GENERAL",stage:"ARCHIVED",labelKey:"status.ARCHIVED_GENERAL",color:"neutral",boardColumn:"REJECTED",order:980},KEEP_IN_TOUCH:{key:"KEEP_IN_TOUCH",stage:"ARCHIVED",labelKey:"status.KEEP_IN_TOUCH",color:"neutral",boardColumn:"REJECTED",order:990},WITHDREW_BEFORE_START:{key:"WITHDREW_BEFORE_START",stage:"ARCHIVED",labelKey:"status.WITHDREW_BEFORE_START",color:"neutral",boardColumn:"REJECTED",order:995}}).map(([e,t])=>[e,{...t,boardColumn:t.stage}])),r=Object.keys(a),s={ACTIVE:{key:"ACTIVE",labelKey:"board.column.ACTIVE",order:1},INTERVIEW:{key:"INTERVIEW",labelKey:"board.column.INTERVIEW",order:2},OFFER:{key:"OFFER",labelKey:"board.column.OFFER",order:3},HIRED:{key:"HIRED",labelKey:"board.column.HIRED",order:4},REJECTED:{key:"REJECTED",labelKey:"board.column.REJECTED",order:5},NO_RESPONSE:{key:"NO_RESPONSE",labelKey:"board.column.NO_RESPONSE",order:6},ARCHIVED:{key:"ARCHIVED",labelKey:"board.column.ARCHIVED",order:7}},n=o.map(e=>s[e]).sort((e,t)=>e.order-t.order),l={neutral:"bg-muted text-foreground",info:"bg-blue-100 text-blue-900",warning:"bg-amber-100 text-amber-900",success:"bg-emerald-100 text-emerald-900",danger:"bg-red-100 text-red-900",purple:"bg-purple-100 text-purple-900"},u={neutral:"bg-status-neutral",info:"bg-status-info",warning:"bg-status-warning",success:"bg-status-success",danger:"bg-status-danger",purple:"bg-status-purple"},I={neutral:"#64748b",info:"#2563eb",warning:"#d97706",success:"#059669",danger:"#dc2626",purple:"#7c3aed"},c={ACTIVE:"info",INTERVIEW:"purple",OFFER:"warning",HIRED:"success",REJECTED:"danger",NO_RESPONSE:"neutral",ARCHIVED:"neutral"};function R(e){return c[i(e).stage]}const T={ACTIVE:"info",INTERVIEW:"purple",OFFER:"warning",HIRED:"success",REJECTED:"danger",NO_RESPONSE:"neutral",ARCHIVED:"neutral"},d={ACTIVE:I[T.ACTIVE],INTERVIEW:I[T.INTERVIEW],OFFER:I[T.OFFER],HIRED:I[T.HIRED],REJECTED:I[T.REJECTED],NO_RESPONSE:I[T.NO_RESPONSE],ARCHIVED:I[T.ARCHIVED]},C=Object.values(a).sort((e,t)=>e.order-t.order);function D(e){return"string"==typeof e&&e in a}function i(e){return a[e]}function A(e){const t=a[e];return t?.boardColumn??"ACTIVE"}function p(e){return C.filter(t=>t.stage===e)}const y={SAVED:"SAVED",PLANNED:"READY_TO_APPLY",APPLIED:"APPLIED",VIEWED:"RESPONSE_RECEIVED",INTERVIEW_1:"HR_CALL_SCHEDULED",INTERVIEW_2:"TECH_SCHEDULED",TEST_TASK:"TEST_TASK_RECEIVED",OFFER:"OFFER_RECEIVED",REJECTED:"REJECTED_PRE_INTERVIEW",NO_RESPONSE:"GHOSTING"};function _(e){if("string"!=typeof e)return null;const t=e.toUpperCase();return t in y?y[t]:null}function S(e){return e&&"object"==typeof e?e:null}function g(e){if(D(e))return e;const t=_(e);if(t)return t;if("string"==typeof e){const t=e.trim().toUpperCase().replace(/[\s-]+/g,"_");if(D(t))return t;if(o.includes(t))return function(e){const t=C.filter(t=>t.boardColumn===e).sort((e,t)=>e.order-t.order)[0];return t?.key??"SAVED"}(t)}return null}const b=function(e){const t=S(e),E=S(t?.process),o=E?.stage,r=E?.subStatus;if("string"==typeof o&&"string"==typeof r&&D(r))return{stage:a[r].stage,subStatus:r,changed:o!==a[r].stage};const s=_(E?.status);return s?{stage:a[s].stage,subStatus:s,changed:!0}:{stage:"ACTIVE",subStatus:"SAVED",changed:!0}}},65546(e,t,E){E(24589),E(80784)}}]);
//# sourceMappingURL=5019.05e72b89.chunk.js.map