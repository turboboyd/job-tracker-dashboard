{"version":3,"file":"assets/js/5019.05e72b89.chunk.js","mappings":"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","sources":["webpack://job-tracker-dashboard/./src/entities/loopMatch/api/loopMatchesApi.ts","webpack://job-tracker-dashboard/./src/entities/application/model/status.ts"],"sourcesContent":["import {\n  deleteDoc,\n  getDoc,\n  getDocs,\n  query,\n  where,\n  Timestamp,\n} from \"firebase/firestore\";\n\nimport { normalizeStatus, STATUS } from \"src/entities/application/model/status\";\nimport {\n  createApplication,\n  updateApplicationWithHistory,\n  changeStatus,\n  type ApplicationDoc,\n  type ProcessStatus,\n} from \"src/features/applications/firestoreApplications\";\nimport { userApplicationDoc, userApplicationsCol } from \"src/shared/api/firestoreRefs\";\nimport { baseApi } from \"src/shared/api/rtk/baseApi\";\nimport { requireUidFromState } from \"src/shared/api/rtk/requireUid\";\nimport { db } from \"src/shared/config/firebase/firebase\";\n\nimport type {\n  CreateLoopMatchInput,\n  DeleteLoopMatchInput,\n  LoopMatch,\n  UpdateLoopMatchInput,\n  UpdateLoopMatchStatusInput,\n} from \"../model/types\";\n\n\ntype ApiError = { message: string };\n\nfunction toMsg(e: unknown): string {\n  return e instanceof Error ? e.message : String(e);\n}\n\nfunction rtkError(message: string) {\n  return { error: { message } as ApiError } as const;\n}\n\nfunction isoNow(): string {\n  return new Date().toISOString();\n}\n\nexport type GetMatchesByLoopArgs = { loopId: string };\nexport type GetMatchArgs = { matchId: string };\n\nfunction normalizeUrl(input: string): string {\n  const v = String(input ?? \"\").trim();\n  if (!v) return \"\";\n  if (!/^https?:\\/\\//i.test(v)) return `https://${v}`;\n  return v;\n}\n\nfunction cleanPatch(patch: UpdateLoopMatchInput[\"patch\"]): UpdateLoopMatchInput[\"patch\"] {\n  const out: UpdateLoopMatchInput[\"patch\"] = { ...patch };\n  if (typeof out.url === \"string\") out.url = normalizeUrl(out.url);\n  return out;\n}\n\n// Loop match status is the shared StatusKey.\n\nfunction statusKeyToProcessStatus(s: LoopMatch[\"status\"]): ProcessStatus {\n  const meta = STATUS[s];\n  switch (meta.stage) {\n    case \"ACTIVE\":\n      return \"APPLIED\";\n    case \"INTERVIEW\":\n      return \"INTERVIEW_1\";\n    case \"OFFER\":\n      return \"OFFER\";\n    case \"HIRED\":\n      // Backend enum has no dedicated \"HIRED/STARTED\" value. Keep it in the latest available stage.\n      return \"OFFER\";\n    case \"REJECTED\":\n      return \"REJECTED\";\n    case \"NO_RESPONSE\":\n      return \"NO_RESPONSE\";\n    case \"ARCHIVED\":\n      // Backend enum has no archived value. Treat as inactive/saved.\n      return \"SAVED\";\n    default:\n      return \"SAVED\";\n  }\n}\n\ntype ToDateLike = { toDate: () => Date };\n\nfunction isToDateLike(x: unknown): x is ToDateLike {\n  const r = x && typeof x === \"object\" ? (x as Record<string, unknown>) : null;\n  return typeof r?.toDate === \"function\";\n}\n\nfunction tsToIso(v: unknown): string {\n  if (!v) return \"\";\n  if (v instanceof Timestamp) return v.toDate().toISOString();\n  if (v instanceof Date) return v.toISOString();\n  if (typeof v === \"number\") return new Date(v).toISOString();\n  if (isToDateLike(v)) return v.toDate().toISOString();\n  return \"\";\n}\n\nfunction mapApplicationToLoopMatch(id: string, app: ApplicationDoc): LoopMatch {\n  const matchedAt =\n    tsToIso(app.loopLinkage?.matchedAt) || tsToIso(app.createdAt) || isoNow();\n  const createdAt = tsToIso(app.createdAt) || matchedAt;\n  const updatedAt = tsToIso(app.updatedAt) || createdAt;\n\n  const norm = normalizeStatus(app);\n\n  return {\n    id,\n    loopId: app.loopLinkage?.loopId ?? \"\",\n    title: app.job.roleTitle,\n    company: app.job.companyName,\n    location: app.job.locationText ?? \"\",\n    platform:\n      (typeof app.loopLinkage?.platform === \"string\" && app.loopLinkage.platform) ||\n      (typeof app.job?.source === \"string\" && app.job.source) ||\n      \"\",\n    url: app.job.vacancyUrl ?? \"\",\n    description: app.vacancy?.rawDescription ?? \"\",\n    status: norm.subStatus,\n    matchedAt,\n    createdAt,\n    updatedAt,\n  };\n}\n\nexport const loopMatchesApi = baseApi.injectEndpoints({\n  endpoints: (builder) => ({\n    // --------------------\n    // LIST: all matches\n    // --------------------\n    getAllMatches: builder.query<LoopMatch[], void>({\n      async queryFn(_arg, api) {\n        try {\n          const uid = requireUidFromState(api.getState());\n          // Unified source: users/{uid}/applications.\n          // We avoid orderBy to keep indexes simple and sort client-side.\n          const snap = await getDocs(query(userApplicationsCol(uid)));\n          const items: LoopMatch[] = snap.docs\n            .map((d) => ({ id: d.id, app: d.data() as ApplicationDoc }))\n            .filter((x) => Boolean(x.app.loopLinkage?.loopId))\n            .map((x) => mapApplicationToLoopMatch(x.id, x.app));\n\n          items.sort((a, b) => (b.matchedAt || \"\").localeCompare(a.matchedAt || \"\"));\n          return { data: items };\n        } catch (e) {\n          return rtkError(toMsg(e));\n        }\n      },\n      providesTags: (res) =>\n        res\n          ? [\n              ...res.map((m) => ({ type: \"LoopMatches\" as const, id: m.id })),\n              { type: \"LoopMatches\" as const, id: \"LIST:ALL\" },\n            ]\n          : [{ type: \"LoopMatches\" as const, id: \"LIST:ALL\" }],\n    }),\n\n    // --------------------\n    // LIST: matches by loopId\n    // --------------------\n    getMatchesByLoop: builder.query<LoopMatch[], GetMatchesByLoopArgs>({\n      async queryFn({ loopId }, api) {\n        try {\n          const uid = requireUidFromState(api.getState());\n          const snap = await getDocs(\n            query(userApplicationsCol(uid), where(\"loopLinkage.loopId\", \"==\", loopId)),\n          );\n\n          const items: LoopMatch[] = snap.docs.map((d) =>\n            mapApplicationToLoopMatch(d.id, d.data() as ApplicationDoc),\n          );\n\n          items.sort((a, b) => (b.matchedAt || \"\").localeCompare(a.matchedAt || \"\"));\n          return { data: items };\n        } catch (e) {\n          return rtkError(toMsg(e));\n        }\n      },\n      providesTags: (_res, _err, arg) => [\n        { type: \"LoopMatches\" as const, id: `LIST:LOOP:${arg.loopId}` },\n      ],\n    }),\n\n    // --------------------\n    // GET: one match by id\n    // --------------------\n    getMatch: builder.query<LoopMatch | null, GetMatchArgs>({\n      async queryFn({ matchId }, api) {\n        try {\n          const uid = requireUidFromState(api.getState());\n          const snap = await getDoc(userApplicationDoc(uid, matchId));\n          if (!snap.exists()) return { data: null };\n\n          return { data: mapApplicationToLoopMatch(snap.id, snap.data() as ApplicationDoc) };\n        } catch (e) {\n          return rtkError(toMsg(e));\n        }\n      },\n      providesTags: (_res, _err, arg) => [\n        { type: \"LoopMatches\" as const, id: arg.matchId },\n      ],\n    }),\n\n    // --------------------\n    // CREATE\n    // --------------------\n    createMatch: builder.mutation<{ id: string }, CreateLoopMatchInput>({\n      async queryFn(input, api) {\n        try {\n          const uid = requireUidFromState(api.getState());\n\n          const id = await createApplication(db, uid, {\n            companyName: input.company,\n            roleTitle: input.title,\n            locationText: input.location,\n            vacancyUrl: normalizeUrl(input.url),\n            source: String(input.platform ?? \"\").toLowerCase(),\n            rawDescription: input.description,\n            status: statusKeyToProcessStatus(input.status),\n\n            loopId: input.loopId,\n            loopPlatform: String(input.platform ?? \"\").toLowerCase(),\n            loopMatchedAt: input.matchedAt ? new Date(input.matchedAt) : undefined,\n            loopSource: \"loop\",\n          });\n\n          return { data: { id } };\n        } catch (e) {\n          return rtkError(toMsg(e));\n        }\n      },\n      invalidatesTags: (_r, _e, arg) => [\n        { type: \"LoopMatches\" as const, id: \"LIST:ALL\" },\n        { type: \"LoopMatches\" as const, id: `LIST:LOOP:${arg.loopId}` },\n      ],\n    }),\n\n    // --------------------\n    // UPDATE: status only\n    // --------------------\n    updateMatchStatus: builder.mutation<void, UpdateLoopMatchStatusInput>({\n      async queryFn({ matchId, status }, api) {\n        try {\n          const uid = requireUidFromState(api.getState());\n\n          await changeStatus(db, uid, matchId, statusKeyToProcessStatus(status));\n\n          return { data: undefined };\n        } catch (e) {\n          return rtkError(toMsg(e));\n        }\n      },\n      invalidatesTags: (_r, _e, arg) => [\n        { type: \"LoopMatches\" as const, id: arg.matchId },\n        { type: \"LoopMatches\" as const, id: \"LIST:ALL\" },\n        { type: \"LoopMatches\" as const, id: `LIST:LOOP:${arg.loopId}` },\n      ],\n    }),\n\n    // --------------------\n    // UPDATE: fields\n    // --------------------\n    updateMatch: builder.mutation<void, UpdateLoopMatchInput>({\n      async queryFn({ matchId, patch }, api) {\n        try {\n          const uid = requireUidFromState(api.getState());\n\n          const p = cleanPatch(patch);\n          const dotPatch: Record<string, unknown> = {};\n\n          if (typeof p.title === \"string\") dotPatch[\"job.roleTitle\"] = p.title;\n          if (typeof p.company === \"string\") dotPatch[\"job.companyName\"] = p.company;\n          if (typeof p.location === \"string\") dotPatch[\"job.locationText\"] = p.location;\n          if (typeof p.url === \"string\") dotPatch[\"job.vacancyUrl\"] = p.url;\n          if (typeof p.platform === \"string\") {\n            dotPatch[\"loopLinkage.platform\"] = p.platform;\n            dotPatch[\"job.source\"] = p.platform;\n          }\n          if (typeof p.description === \"string\") dotPatch[\"vacancy.rawDescription\"] = p.description;\n          if (typeof p.matchedAt === \"string\" && p.matchedAt.trim()) {\n            dotPatch[\"loopLinkage.matchedAt\"] = Timestamp.fromDate(new Date(p.matchedAt));\n          }\n          if (typeof p.status === \"string\") {\n            dotPatch[\"process.status\"] = statusKeyToProcessStatus(p.status);\n            dotPatch[\"process.lastStatusChangeAt\"] = Timestamp.fromDate(new Date());\n          }\n\n          await updateApplicationWithHistory(db, uid, matchId, dotPatch, () => [\n            {\n              actor: \"user\",\n              type: \"FIELD_CHANGE\",\n              fieldPath: \"legacy.loopMatch\",\n              oldValue: null,\n              newValue: p,\n            },\n          ]);\n\n          return { data: undefined };\n        } catch (e) {\n          return rtkError(toMsg(e));\n        }\n      },\n      invalidatesTags: (_r, _e, arg) => [\n        { type: \"LoopMatches\" as const, id: arg.matchId },\n        { type: \"LoopMatches\" as const, id: \"LIST:ALL\" },\n        // We don't know the loopId from patch alone; we invalidate all matches list.\n      ],\n    }),\n\n    // --------------------\n    // DELETE\n    // --------------------\n    deleteMatch: builder.mutation<void, DeleteLoopMatchInput>({\n      async queryFn({ matchId }, api) {\n        try {\n          const uid = requireUidFromState(api.getState());\n          await deleteDoc(userApplicationDoc(uid, matchId));\n          return { data: undefined };\n        } catch (e) {\n          return rtkError(toMsg(e));\n        }\n      },\n      invalidatesTags: (_r, _e, arg) => [\n        { type: \"LoopMatches\" as const, id: arg.matchId },\n        { type: \"LoopMatches\" as const, id: \"LIST:ALL\" },\n        { type: \"LoopMatches\" as const, id: `LIST:LOOP:${arg.loopId}` },\n      ],\n    }),\n  }),\n});\n\nexport const {\n  useGetAllMatchesQuery,\n  useGetMatchesByLoopQuery,\n  useGetMatchQuery,\n  useCreateMatchMutation,\n  useUpdateMatchStatusMutation,\n  useUpdateMatchMutation,\n  useDeleteMatchMutation,\n} = loopMatchesApi;\n","/**\n * Stage = основной этап процесса.\n * Это поле должно быть стабильным (используется в фильтрах/запросах/графиках).\n */\nexport type Stage =\n  | \"ACTIVE\"\n  | \"INTERVIEW\"\n  | \"OFFER\"\n  | \"HIRED\"\n  | \"REJECTED\"\n  | \"NO_RESPONSE\"\n  | \"ARCHIVED\";\n\nexport const STAGES: readonly Stage[] = [\n  \"ACTIVE\",\n  \"INTERVIEW\",\n  \"OFFER\",\n  \"HIRED\",\n  \"REJECTED\",\n  \"NO_RESPONSE\",\n  \"ARCHIVED\",\n] as const;\n\n/**\n * “Статус” = конкретное состояние карточки (подстатус).\n * Stage используется для группировки/фильтров, но UI чаще работает со StatusKey.\n */\nexport type StatusKey =\n  // ACTIVE (prep + applied + waiting)\n  | \"SAVED\"\n  | \"REVIEWED\"\n  | \"CV_ADAPTING\"\n  | \"COVER_LETTER_WRITING\"\n  | \"READY_TO_APPLY\"\n  | \"APPLIED\"\n  | \"REAPPLIED\"\n  | \"WAITING_RESPONSE\"\n  | \"AUTO_REPLY_RECEIVED\"\n  | \"RESPONSE_RECEIVED\"\n  | \"MORE_INFO_REQUESTED\"\n  | \"FOLLOW_UP_REQUIRED\"\n  | \"WONT_APPLY\"\n  // INTERVIEW\n  | \"HR_CALL_SCHEDULED\"\n  | \"HR_PASSED\"\n  | \"HR_FAILED\"\n  | \"TECH_SCHEDULED\"\n  | \"TECH_PASSED\"\n  | \"TECH_FAILED\"\n  | \"FINAL_INTERVIEW\"\n  | \"TEST_TASK_RECEIVED\"\n  | \"TEST_TASK_SUBMITTED\"\n  | \"WAITING_DECISION\"\n  // OFFER\n  | \"OFFER_RECEIVED\"\n  | \"OFFER_REVIEWING\"\n  | \"NEGOTIATING\"\n  | \"OFFER_ACCEPTED\"\n  | \"OFFER_DECLINED\"\n  | \"OFFER_RESCINDED\"\n  // HIRED\n  | \"START_PLANNED\"\n  | \"STARTED\"\n  // REJECTED / NO_RESPONSE / ARCHIVED\n  | \"REJECTED_PRE_INTERVIEW\"\n  | \"REJECTED_AFTER_INTERVIEW\"\n  | \"ROLE_CLOSED\"\n  | \"GHOSTING\"\n  | \"ARCHIVED_GENERAL\"\n  | \"KEEP_IN_TOUCH\"\n  | \"WITHDREW_BEFORE_START\";\n\nexport type StatusColor =\n  | \"neutral\"\n  | \"info\"\n  | \"warning\"\n  | \"success\"\n  | \"danger\"\n  | \"purple\";\n\nexport const STATUS_COLORS: readonly StatusColor[] = [\n  \"neutral\",\n  \"info\",\n  \"warning\",\n  \"success\",\n  \"danger\",\n  \"purple\",\n] as const;\n\nexport type BoardColumnKey =\n  | \"ACTIVE\"\n  | \"INTERVIEW\"\n  | \"OFFER\"\n  | \"HIRED\"\n  | \"REJECTED\"\n  | \"NO_RESPONSE\"\n  | \"ARCHIVED\";\n\n\nexport const BOARD_COLUMN_KEYS: readonly BoardColumnKey[] = [\n  \"ACTIVE\",\n  \"INTERVIEW\",\n  \"OFFER\",\n  \"HIRED\",\n  \"REJECTED\",\n  \"NO_RESPONSE\",\n  \"ARCHIVED\",\n] as const;\n\nexport type StatusMeta = {\n  key: StatusKey;\n  stage: Stage;\n  labelKey: string;\n  color: StatusColor;\n  boardColumn: BoardColumnKey;\n  order: number;\n};\n\nconst STATUS_BASE: Record<StatusKey, StatusMeta> = {\n  // =========================\n  // ACTIVE\n  // =========================\n  SAVED: {\n    key: \"SAVED\",\n    stage: \"ACTIVE\",\n    labelKey: \"status.SAVED\",\n    color: \"neutral\",\n    boardColumn: \"ACTIVE\",\n    order: 10,\n  },\n  REVIEWED: {\n    key: \"REVIEWED\",\n    stage: \"ACTIVE\",\n    labelKey: \"status.REVIEWED\",\n    color: \"neutral\",\n    boardColumn: \"ACTIVE\",\n    order: 20,\n  },\n  CV_ADAPTING: {\n    key: \"CV_ADAPTING\",\n    stage: \"ACTIVE\",\n    labelKey: \"status.CV_ADAPTING\",\n    color: \"info\",\n    boardColumn: \"ACTIVE\",\n    order: 30,\n  },\n  COVER_LETTER_WRITING: {\n    key: \"COVER_LETTER_WRITING\",\n    stage: \"ACTIVE\",\n    labelKey: \"status.COVER_LETTER_WRITING\",\n    color: \"info\",\n    boardColumn: \"ACTIVE\",\n    order: 40,\n  },\n  READY_TO_APPLY: {\n    key: \"READY_TO_APPLY\",\n    stage: \"ACTIVE\",\n    labelKey: \"status.READY_TO_APPLY\",\n    color: \"info\",\n    boardColumn: \"ACTIVE\",\n    order: 50,\n  },\n  APPLIED: {\n    key: \"APPLIED\",\n    stage: \"ACTIVE\",\n    labelKey: \"status.APPLIED\",\n    color: \"warning\",\n    boardColumn: \"ACTIVE\",\n    order: 60,\n  },\n  REAPPLIED: {\n    key: \"REAPPLIED\",\n    stage: \"ACTIVE\",\n    labelKey: \"status.REAPPLIED\",\n    color: \"warning\",\n    boardColumn: \"ACTIVE\",\n    order: 70,\n  },\n  WAITING_RESPONSE: {\n    key: \"WAITING_RESPONSE\",\n    stage: \"ACTIVE\",\n    labelKey: \"status.WAITING_RESPONSE\",\n    color: \"warning\",\n    boardColumn: \"ACTIVE\",\n    order: 80,\n  },\n  AUTO_REPLY_RECEIVED: {\n    key: \"AUTO_REPLY_RECEIVED\",\n    stage: \"ACTIVE\",\n    labelKey: \"status.AUTO_REPLY_RECEIVED\",\n    color: \"warning\",\n    boardColumn: \"ACTIVE\",\n    order: 90,\n  },\n  RESPONSE_RECEIVED: {\n    key: \"RESPONSE_RECEIVED\",\n    stage: \"ACTIVE\",\n    labelKey: \"status.RESPONSE_RECEIVED\",\n    color: \"info\",\n    boardColumn: \"ACTIVE\",\n    order: 100,\n  },\n  MORE_INFO_REQUESTED: {\n    key: \"MORE_INFO_REQUESTED\",\n    stage: \"ACTIVE\",\n    labelKey: \"status.MORE_INFO_REQUESTED\",\n    color: \"info\",\n    boardColumn: \"ACTIVE\",\n    order: 110,\n  },\n  FOLLOW_UP_REQUIRED: {\n    key: \"FOLLOW_UP_REQUIRED\",\n    stage: \"ACTIVE\",\n    labelKey: \"status.FOLLOW_UP_REQUIRED\",\n    color: \"warning\",\n    boardColumn: \"ACTIVE\",\n    order: 120,\n  },\n  WONT_APPLY: {\n    key: \"WONT_APPLY\",\n    stage: \"REJECTED\",\n    labelKey: \"status.WONT_APPLY\",\n    color: \"danger\",\n    boardColumn: \"REJECTED\",\n    order: 900,\n  },\n\n  // =========================\n  // INTERVIEW\n  // =========================\n  HR_CALL_SCHEDULED: {\n    key: \"HR_CALL_SCHEDULED\",\n    stage: \"INTERVIEW\",\n    labelKey: \"status.HR_CALL_SCHEDULED\",\n    color: \"purple\",\n    boardColumn: \"INTERVIEW\",\n    order: 200,\n  },\n  HR_PASSED: {\n    key: \"HR_PASSED\",\n    stage: \"INTERVIEW\",\n    labelKey: \"status.HR_PASSED\",\n    color: \"purple\",\n    boardColumn: \"INTERVIEW\",\n    order: 210,\n  },\n  HR_FAILED: {\n    key: \"HR_FAILED\",\n    stage: \"REJECTED\",\n    labelKey: \"status.HR_FAILED\",\n    color: \"danger\",\n    boardColumn: \"REJECTED\",\n    order: 910,\n  },\n  TECH_SCHEDULED: {\n    key: \"TECH_SCHEDULED\",\n    stage: \"INTERVIEW\",\n    labelKey: \"status.TECH_SCHEDULED\",\n    color: \"purple\",\n    boardColumn: \"INTERVIEW\",\n    order: 220,\n  },\n  TECH_PASSED: {\n    key: \"TECH_PASSED\",\n    stage: \"INTERVIEW\",\n    labelKey: \"status.TECH_PASSED\",\n    color: \"purple\",\n    boardColumn: \"INTERVIEW\",\n    order: 230,\n  },\n  TECH_FAILED: {\n    key: \"TECH_FAILED\",\n    stage: \"REJECTED\",\n    labelKey: \"status.TECH_FAILED\",\n    color: \"danger\",\n    boardColumn: \"REJECTED\",\n    order: 920,\n  },\n  FINAL_INTERVIEW: {\n    key: \"FINAL_INTERVIEW\",\n    stage: \"INTERVIEW\",\n    labelKey: \"status.FINAL_INTERVIEW\",\n    color: \"purple\",\n    boardColumn: \"INTERVIEW\",\n    order: 240,\n  },\n  TEST_TASK_RECEIVED: {\n    key: \"TEST_TASK_RECEIVED\",\n    stage: \"INTERVIEW\",\n    labelKey: \"status.TEST_TASK_RECEIVED\",\n    color: \"purple\",\n    boardColumn: \"INTERVIEW\",\n    order: 250,\n  },\n  TEST_TASK_SUBMITTED: {\n    key: \"TEST_TASK_SUBMITTED\",\n    stage: \"INTERVIEW\",\n    labelKey: \"status.TEST_TASK_SUBMITTED\",\n    color: \"purple\",\n    boardColumn: \"INTERVIEW\",\n    order: 260,\n  },\n  WAITING_DECISION: {\n    key: \"WAITING_DECISION\",\n    stage: \"INTERVIEW\",\n    labelKey: \"status.WAITING_DECISION\",\n    color: \"purple\",\n    boardColumn: \"INTERVIEW\",\n    order: 270,\n  },\n\n  // =========================\n  // OFFER\n  // =========================\n  OFFER_RECEIVED: {\n    key: \"OFFER_RECEIVED\",\n    stage: \"OFFER\",\n    labelKey: \"status.OFFER_RECEIVED\",\n    color: \"success\",\n    boardColumn: \"OFFER\",\n    order: 300,\n  },\n  OFFER_REVIEWING: {\n    key: \"OFFER_REVIEWING\",\n    stage: \"OFFER\",\n    labelKey: \"status.OFFER_REVIEWING\",\n    color: \"success\",\n    boardColumn: \"OFFER\",\n    order: 310,\n  },\n  NEGOTIATING: {\n    key: \"NEGOTIATING\",\n    stage: \"OFFER\",\n    labelKey: \"status.NEGOTIATING\",\n    color: \"success\",\n    boardColumn: \"OFFER\",\n    order: 320,\n  },\n  OFFER_ACCEPTED: {\n    key: \"OFFER_ACCEPTED\",\n    stage: \"HIRED\",\n    labelKey: \"status.OFFER_ACCEPTED\",\n    color: \"success\",\n    boardColumn: \"OFFER\",\n    order: 330,\n  },\n  OFFER_DECLINED: {\n    key: \"OFFER_DECLINED\",\n    stage: \"ARCHIVED\",\n    labelKey: \"status.OFFER_DECLINED\",\n    color: \"neutral\",\n    boardColumn: \"REJECTED\",\n    order: 800,\n  },\n  OFFER_RESCINDED: {\n    key: \"OFFER_RESCINDED\",\n    stage: \"REJECTED\",\n    labelKey: \"status.OFFER_RESCINDED\",\n    color: \"danger\",\n    boardColumn: \"REJECTED\",\n    order: 930,\n  },\n\n  // =========================\n  // HIRED\n  // =========================\n  START_PLANNED: {\n    key: \"START_PLANNED\",\n    stage: \"HIRED\",\n    labelKey: \"status.START_PLANNED\",\n    color: \"success\",\n    boardColumn: \"OFFER\",\n    order: 400,\n  },\n  STARTED: {\n    key: \"STARTED\",\n    stage: \"HIRED\",\n    labelKey: \"status.STARTED\",\n    color: \"success\",\n    boardColumn: \"OFFER\",\n    order: 410,\n  },\n\n  // =========================\n  // REJECTED\n  // =========================\n  REJECTED_PRE_INTERVIEW: {\n    key: \"REJECTED_PRE_INTERVIEW\",\n    stage: \"REJECTED\",\n    labelKey: \"status.REJECTED_PRE_INTERVIEW\",\n    color: \"danger\",\n    boardColumn: \"REJECTED\",\n    order: 940,\n  },\n  REJECTED_AFTER_INTERVIEW: {\n    key: \"REJECTED_AFTER_INTERVIEW\",\n    stage: \"REJECTED\",\n    labelKey: \"status.REJECTED_AFTER_INTERVIEW\",\n    color: \"danger\",\n    boardColumn: \"REJECTED\",\n    order: 950,\n  },\n  ROLE_CLOSED: {\n    key: \"ROLE_CLOSED\",\n    stage: \"REJECTED\",\n    labelKey: \"status.ROLE_CLOSED\",\n    color: \"danger\",\n    boardColumn: \"REJECTED\",\n    order: 960,\n  },\n\n  // =========================\n  // NO_RESPONSE\n  // =========================\n  GHOSTING: {\n    key: \"GHOSTING\",\n    stage: \"NO_RESPONSE\",\n    labelKey: \"status.GHOSTING\",\n    color: \"danger\",\n    boardColumn: \"REJECTED\",\n    order: 970,\n  },\n\n  // =========================\n  // ARCHIVED\n  // =========================\n  ARCHIVED_GENERAL: {\n    key: \"ARCHIVED_GENERAL\",\n    stage: \"ARCHIVED\",\n    labelKey: \"status.ARCHIVED_GENERAL\",\n    color: \"neutral\",\n    boardColumn: \"REJECTED\",\n    order: 980,\n  },\n  KEEP_IN_TOUCH: {\n    key: \"KEEP_IN_TOUCH\",\n    stage: \"ARCHIVED\",\n    labelKey: \"status.KEEP_IN_TOUCH\",\n    color: \"neutral\",\n    boardColumn: \"REJECTED\",\n    order: 990,\n  },\n  WITHDREW_BEFORE_START: {\n    key: \"WITHDREW_BEFORE_START\",\n    stage: \"ARCHIVED\",\n    labelKey: \"status.WITHDREW_BEFORE_START\",\n    color: \"neutral\",\n    boardColumn: \"REJECTED\",\n    order: 995,\n  },\n};\n\nexport const STATUS: Record<StatusKey, StatusMeta> = Object.fromEntries(\n  Object.entries(STATUS_BASE).map(([k, v]) => [k, { ...v, boardColumn: v.stage }]),\n) as Record<StatusKey, StatusMeta>;\n\nexport const STATUS_KEYS: readonly StatusKey[] = Object.keys(STATUS) as StatusKey[];\n\nexport const BOARD_COLUMNS: Record<\n  BoardColumnKey,\n  { key: BoardColumnKey; labelKey: string; order: number }\n> = {\n  ACTIVE: { key: \"ACTIVE\", labelKey: \"board.column.ACTIVE\", order: 1 },\n  INTERVIEW: { key: \"INTERVIEW\", labelKey: \"board.column.INTERVIEW\", order: 2 },\n  OFFER: { key: \"OFFER\", labelKey: \"board.column.OFFER\", order: 3 },\n  HIRED: { key: \"HIRED\", labelKey: \"board.column.HIRED\", order: 4 },\n  REJECTED: { key: \"REJECTED\", labelKey: \"board.column.REJECTED\", order: 5 },\n  NO_RESPONSE: { key: \"NO_RESPONSE\", labelKey: \"board.column.NO_RESPONSE\", order: 6 },\n  ARCHIVED: { key: \"ARCHIVED\", labelKey: \"board.column.ARCHIVED\", order: 7 },\n};\n\nexport const BOARD_COLUMNS_LIST: readonly { key: BoardColumnKey; labelKey: string; order: number }[] =\n  BOARD_COLUMN_KEYS.map((k) => BOARD_COLUMNS[k]).sort((a, b) => a.order - b.order);\n\n/**\n * Единственный mapping цветов для UI.\n * Badge/Board/Charts должны использовать ТОЛЬКО meta.color.\n */\nexport const STATUS_COLOR_CLASS: Record<StatusColor, string> = {\n  neutral: \"bg-muted text-foreground\",\n  info: \"bg-blue-100 text-blue-900\",\n  warning: \"bg-amber-100 text-amber-900\",\n  success: \"bg-emerald-100 text-emerald-900\",\n  danger: \"bg-red-100 text-red-900\",\n  purple: \"bg-purple-100 text-purple-900\",\n};\n\n\n/**\n * Dot variant (background only).\n *\n * Derived from StatusColor, so changing meta.color updates dots everywhere.\n */\nexport const STATUS_COLOR_DOT_CLASS: Record<StatusColor, string> = {\n  // Unified status tokens (tailwind -> CSS vars in theme files)\n  neutral: \"bg-status-neutral\",\n  info: \"bg-status-info\",\n  warning: \"bg-status-warning\",\n  success: \"bg-status-success\",\n  danger: \"bg-status-danger\",\n  purple: \"bg-status-purple\",\n};\n\n/**\n * Никаких других источников цветов.\n */\nexport const STATUS_COLOR_HEX: Record<StatusColor, string> = {\n  neutral: \"#64748b\",\n  info: \"#2563eb\",\n  warning: \"#d97706\",\n  success: \"#059669\",\n  danger: \"#dc2626\",\n  purple: \"#7c3aed\",\n};\n\n\n\n/**\n * Stage colors: keep consistent across the whole UI (dots, charts, badges).\n * We intentionally map \"stage\" -> color, so HR_CALL_SCHEDULED and TECH_* share INTERVIEW color etc.\n */\nexport const STAGE_COLOR: Record<Stage, StatusColor> = {\n  ACTIVE: \"info\",\n  INTERVIEW: \"purple\",\n  OFFER: \"warning\",\n  HIRED: \"success\",\n  REJECTED: \"danger\",\n  NO_RESPONSE: \"neutral\",\n  ARCHIVED: \"neutral\",\n};\n\nexport function getStageColorForStatus(status: StatusKey): StatusColor {\n  return STAGE_COLOR[getStatusMeta(status).stage];\n}\n\n/**\n * Column (board stage) colors for charts/legends.\n */\nexport const BOARD_COLUMN_COLOR: Record<BoardColumnKey, StatusColor> = {\n  ACTIVE: \"info\",\n  INTERVIEW: \"purple\",\n  OFFER: \"warning\",\n  HIRED: \"success\",\n  REJECTED: \"danger\",\n  NO_RESPONSE: \"neutral\",\n  ARCHIVED: \"neutral\",\n};\n\nexport const BOARD_COLUMN_COLOR_HEX: Record<BoardColumnKey, string> = {\n  ACTIVE: STATUS_COLOR_HEX[BOARD_COLUMN_COLOR.ACTIVE],\n  INTERVIEW: STATUS_COLOR_HEX[BOARD_COLUMN_COLOR.INTERVIEW],\n  OFFER: STATUS_COLOR_HEX[BOARD_COLUMN_COLOR.OFFER],\n  HIRED: STATUS_COLOR_HEX[BOARD_COLUMN_COLOR.HIRED],\n  REJECTED: STATUS_COLOR_HEX[BOARD_COLUMN_COLOR.REJECTED],\n  NO_RESPONSE: STATUS_COLOR_HEX[BOARD_COLUMN_COLOR.NO_RESPONSE],\n  ARCHIVED: STATUS_COLOR_HEX[BOARD_COLUMN_COLOR.ARCHIVED],\n};\nexport const ALL_STATUSES: StatusMeta[] = Object.values(STATUS).sort(\n  (a, b) => a.order - b.order\n);\n\nexport function isStatusKey(v: unknown): v is StatusKey {\n  return typeof v === \"string\" && (v as StatusKey) in STATUS;\n}\n\nexport function getStatusMeta(status: StatusKey): StatusMeta {\n  return STATUS[status];\n}\n\nexport function getStage(status: StatusKey): Stage {\n  return STATUS[status].stage;\n}\n\nexport function getBoardColumn(status: StatusKey): BoardColumnKey {\n  const meta = STATUS[status];\n  // Defensive: in case legacy/invalid data slipped through.\n  return meta?.boardColumn ?? \"ACTIVE\";\n}\n\nexport function defaultStatusForBoardColumn(col: BoardColumnKey): StatusKey {\n  const first = ALL_STATUSES\n    .filter((s) => s.boardColumn === col)\n    .sort((a, b) => a.order - b.order)[0];\n  return (first?.key ?? \"SAVED\") as StatusKey;\n}\n\nexport function statusesForStage(stage: Stage): StatusMeta[] {\n  return ALL_STATUSES.filter((s) => s.stage === stage);\n}\n\n/**\n * Legacy process.status (старый enum) -> новый StatusKey.\n * Используется только при миграции/нормализации старых документов.\n */\nexport type LegacyProcessStatus =\n  | \"SAVED\"\n  | \"PLANNED\"\n  | \"APPLIED\"\n  | \"VIEWED\"\n  | \"INTERVIEW_1\"\n  | \"INTERVIEW_2\"\n  | \"TEST_TASK\"\n  | \"OFFER\"\n  | \"REJECTED\"\n  | \"NO_RESPONSE\";\n\nconst LEGACY_TO_STATUS: Record<LegacyProcessStatus, StatusKey> = {\n  SAVED: \"SAVED\",\n  PLANNED: \"READY_TO_APPLY\",\n  APPLIED: \"APPLIED\",\n  VIEWED: \"RESPONSE_RECEIVED\",\n  INTERVIEW_1: \"HR_CALL_SCHEDULED\",\n  INTERVIEW_2: \"TECH_SCHEDULED\",\n  TEST_TASK: \"TEST_TASK_RECEIVED\",\n  OFFER: \"OFFER_RECEIVED\",\n  REJECTED: \"REJECTED_PRE_INTERVIEW\",\n  NO_RESPONSE: \"GHOSTING\",\n};\n\nexport function legacyStatusToStatusKey(v: unknown): StatusKey | null {\n  if (typeof v !== \"string\") return null;\n  const up = v.toUpperCase() as LegacyProcessStatus;\n  return up in LEGACY_TO_STATUS ? LEGACY_TO_STATUS[up] : null;\n}\n\nfunction asRecord(v: unknown): Record<string, unknown> | null {\n  return v && typeof v === \"object\" ? (v as Record<string, unknown>) : null;\n}\n\n/**\n * Normalize a raw status value (legacy strings, any casing) into StatusKey.\n * Returns null if value is not recognized.\n */\nexport function normalizeStatusKey(v: unknown): StatusKey | null {\n  // 1) Already a valid StatusKey\n  if (isStatusKey(v)) return v;\n\n  // 2) Legacy enum values (older versions)\n  const legacy = legacyStatusToStatusKey(v);\n  if (legacy) return legacy;\n\n  // 3) Be tolerant to different casing / spaces / hyphens\n  if (typeof v === \"string\") {\n    const up = v.trim().toUpperCase();\n    const normalized = up.replace(/[\\s-]+/g, \"_\");\n    if (isStatusKey(normalized)) return normalized;\n\n    // 4) If someone accidentally stored a board column key instead of subStatus,\n    // map it to the default StatusKey for that column so analytics/board stay consistent.\n    if ((BOARD_COLUMN_KEYS as readonly string[]).includes(normalized)) {\n      return defaultStatusForBoardColumn(normalized as BoardColumnKey);\n    }\n  }\n\n  return null;\n}\n\n/**\n * Нормализация статуса приложения:\n * - если уже есть process.stage + process.subStatus (и subStatus валиден) — возвращаем как есть\n * - иначе пытаемся преобразовать legacy process.status\n * - иначе фоллбек на SAVED/ACTIVE\n */\nexport function normalizeAppStatus(app: unknown): { stage: Stage; subStatus: StatusKey; changed: boolean } {\n  const obj = asRecord(app);\n  const process = asRecord(obj?.[\"process\"]);\n\n  const stageIn = process?.[\"stage\"];\n  const subIn = process?.[\"subStatus\"];\n\n  if (typeof stageIn === \"string\" && typeof subIn === \"string\" && isStatusKey(subIn)) {\n    return {\n      stage: STATUS[subIn].stage,\n      subStatus: subIn,\n      changed: stageIn !== STATUS[subIn].stage,\n    };\n  }\n\n  const legacy = legacyStatusToStatusKey(process?.[\"status\"]);\n  if (legacy) {\n    return { stage: STATUS[legacy].stage, subStatus: legacy, changed: true };\n  }\n\n  return { stage: \"ACTIVE\", subStatus: \"SAVED\", changed: true };\n}\n\n/**\n * Back-compat alias: older code imported normalizeStatus() expecting app normalization.\n */\nexport const normalizeStatus = normalizeAppStatus;\n\nexport function getRepresentativeStatusForColumn(col: BoardColumnKey): StatusKey {\n  // Pick the earliest status (by order) that belongs to this board column.\n  const found = STATUS_KEYS.map((k) => STATUS[k])\n    .filter((m) => m.boardColumn === col)\n    .sort((a, b) => a.order - b.order)[0];\n  return found?.key ?? STATUS_KEYS[0];\n}\n"],"names":["toMsg","e","Error","message","String","rtkError","error","normalizeUrl","input","v","trim","test","statusKeyToProcessStatus","s","STATUS","stage","tsToIso","Timestamp","toDate","toISOString","Date","x","r","isToDateLike","mapApplicationToLoopMatch","id","app","matchedAt","loopLinkage","createdAt","updatedAt","norm","normalizeStatus","loopId","title","job","roleTitle","company","companyName","location","locationText","platform","source","url","vacancyUrl","description","vacancy","rawDescription","status","subStatus","loopMatchesApi","baseApi","injectEndpoints","endpoints","builder","getAllMatches","query","queryFn","_arg","api","uid","requireUidFromState","getState","items","getDocs","userApplicationsCol","docs","map","d","data","filter","Boolean","sort","a","b","localeCompare","providesTags","res","m","type","getMatchesByLoop","where","_res","_err","arg","getMatch","matchId","snap","getDoc","userApplicationDoc","exists","createMatch","mutation","createApplication","db","toLowerCase","loopPlatform","loopMatchedAt","undefined","loopSource","invalidatesTags","_r","_e","updateMatchStatus","changeStatus","updateMatch","patch","p","out","cleanPatch","dotPatch","fromDate","updateApplicationWithHistory","actor","fieldPath","oldValue","newValue","deleteMatch","deleteDoc","useGetAllMatchesQuery","useGetMatchesByLoopQuery","useGetMatchQuery","useCreateMatchMutation","useUpdateMatchStatusMutation","useUpdateMatchMutation","useDeleteMatchMutation","BOARD_COLUMN_KEYS","Object","fromEntries","entries","SAVED","key","labelKey","color","boardColumn","order","REVIEWED","CV_ADAPTING","COVER_LETTER_WRITING","READY_TO_APPLY","APPLIED","REAPPLIED","WAITING_RESPONSE","AUTO_REPLY_RECEIVED","RESPONSE_RECEIVED","MORE_INFO_REQUESTED","FOLLOW_UP_REQUIRED","WONT_APPLY","HR_CALL_SCHEDULED","HR_PASSED","HR_FAILED","TECH_SCHEDULED","TECH_PASSED","TECH_FAILED","FINAL_INTERVIEW","TEST_TASK_RECEIVED","TEST_TASK_SUBMITTED","WAITING_DECISION","OFFER_RECEIVED","OFFER_REVIEWING","NEGOTIATING","OFFER_ACCEPTED","OFFER_DECLINED","OFFER_RESCINDED","START_PLANNED","STARTED","REJECTED_PRE_INTERVIEW","REJECTED_AFTER_INTERVIEW","ROLE_CLOSED","GHOSTING","ARCHIVED_GENERAL","KEEP_IN_TOUCH","WITHDREW_BEFORE_START","k","STATUS_KEYS","keys","BOARD_COLUMNS","ACTIVE","INTERVIEW","OFFER","HIRED","REJECTED","NO_RESPONSE","ARCHIVED","BOARD_COLUMNS_LIST","STATUS_COLOR_CLASS","neutral","info","warning","success","danger","purple","STATUS_COLOR_DOT_CLASS","STATUS_COLOR_HEX","STAGE_COLOR","getStageColorForStatus","getStatusMeta","BOARD_COLUMN_COLOR","BOARD_COLUMN_COLOR_HEX","ALL_STATUSES","values","isStatusKey","getBoardColumn","meta","statusesForStage","LEGACY_TO_STATUS","PLANNED","VIEWED","INTERVIEW_1","INTERVIEW_2","TEST_TASK","legacyStatusToStatusKey","up","toUpperCase","asRecord","normalizeStatusKey","legacy","normalized","replace","includes","col","first","defaultStatusForBoardColumn","obj","process","stageIn","subIn","changed"],"ignoreList":[],"sourceRoot":""}