{"version":3,"file":"assets/js/1004.9cd2358b.chunk.js","mappings":"iRAmBA,SAASA,EAAcC,GACrB,MAAMC,EAAI,IAAIC,KAAKF,GAEnB,OADAC,EAAEE,SAAS,EAAG,EAAG,EAAG,GACbF,EAAEG,SACX,CASO,SAASC,IACd,MAAM,EAAEC,IAAMC,EAAAA,EAAAA,SAAeC,EAAW,CAAEC,UAAW,eAC9CC,EAAgBC,IAAqBC,EAAAA,EAAAA,WAAS,IAG9CC,IAASD,EAAAA,EAAAA,UAAS,IAAMV,KAAKY,QAE7BC,EAAOC,IAAYJ,EAAAA,EAAAA,UAAmB,OACtCK,EAAMC,IAAWN,EAAAA,EAAAA,UAAkB,YACnCO,EAAaC,IAAkBR,EAAAA,EAAAA,UAAsB,OAEtD,MAAES,EAAK,YAAEC,EAAW,eAAEC,EAAc,aAAEC,IAAiBC,EAAAA,EAAAA,KAEvDC,GAAkBC,EAAAA,EAAAA,SAAQ,KAC9B,IAAIC,EAAS,EACTC,EAAOhB,EAEX,GAAc,WAAVE,GAAsBI,EACxBS,EAAS7B,EAAcoB,EAAYW,KAAK1B,WACxCyB,EAAO9B,EAAcoB,EAAYY,GAAG3B,WAAa,MAAsB,MAClE,CACL,MAAM4B,EA5BZ,SAAoBjB,GAClB,MAAc,QAAVA,EAAwB,IACd,QAAVA,EAAwB,GACd,QAAVA,EAAwB,GACrB,CACT,CAuBmBkB,CAAWlB,GACxBa,EAASf,EAAe,GAAPmB,EAAY,GAAK,GAAK,IACvCH,EAAOhB,CACT,CAEA,OAAOW,EAAaU,OAAQC,IAC1B,MAAMC,EACK,YAATnB,IACIoB,EAAAA,EAAAA,GAASF,EAAEG,aACXD,EAAAA,EAAAA,GAASF,EAAEI,WACjB,QAAKH,GACEA,GAAMR,GAAUQ,GAAMP,KAE9B,CAACL,EAAcT,EAAOE,EAAME,EAAaN,IAE5C,OACE2B,EAAAA,EAAAA,MAAA,OAAKC,UAAU,uBAAsBC,SAAA,EACnCC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,+FAA8FC,UAC3GF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,qCAAoCC,SAAA,EACjDF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,0CAAyCC,SAAA,EACtDC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,0CAAyCC,SACrDpC,EAAE,iBAAkB,gBAGvBkC,EAAAA,EAAAA,MAACI,EAAAA,GAAM,CACLC,KAAK,KACLC,QAAQ,UACRC,MAAM,OACNN,UAAU,QACVO,QAASA,IAAMrC,GAAkB,GAAM+B,SAAA,EAEvCC,EAAAA,EAAAA,KAACM,EAAAA,EAAiB,CAACR,UAAU,YAC5BnC,EAAE,qBAAsB,gBAI7BqC,EAAAA,EAAAA,KAACO,EAAAA,GAAgB,UAIrBP,EAAAA,EAAAA,KAACQ,EAAAA,GAAyB,CACxBC,KAAM1C,EACN2C,aAAc1C,EACd2C,MAAOhC,EACPD,MAAOA,EACPkC,SAAUhC,KAGZoB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,8BAA6BC,UAC1CF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,gBAAeC,SAAA,EAC5BC,EAAAA,EAAAA,KAACa,EAAAA,GAAmB,CAClBC,QAASjC,EACTT,MAAOA,EACPE,KAAMA,EACNE,YAAaA,EACbuC,cAAe1C,EACf2C,aAAczC,EACd0C,oBAAqBxC,KAGvBoB,EAAAA,EAAAA,MAAA,OAAKC,UAAU,wCAAuCC,SAAA,EACpDC,EAAAA,EAAAA,KAACkB,EAAAA,GAAqB,CAACJ,QAAS/B,KAChCiB,EAAAA,EAAAA,KAACmB,EAAAA,GAAwB,CAACL,QAAS/B,cAM/C,CAEA,S","sources":["webpack://job-tracker-dashboard/./src/pages/DashboardPage/DashboardAnalyticsPage.tsx"],"sourcesContent":["import { SlidersHorizontal } from \"lucide-react\";\nimport { useMemo, useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\n\nimport { toMillis } from \"src/shared/lib/firestore/toMillis\";\nimport { Button } from \"src/shared/ui\";\n\nimport { useDashboardData } from \"./model/useDashboardData\";\nimport {\n  DashboardLoopsFilterModal,\n  DashboardTabsNav,\n  DashboardTrendsCard,\n  DashboardInsightsCard,\n  DashboardStatusRadarCard,\n} from \"./ui\";\nimport type { ModeKey, RangeKey } from \"./ui/trends/trends.types\";\n\ntype CustomRange = { from: Date; to: Date } | null;\n\nfunction clampDayStart(ms: number): number {\n  const d = new Date(ms);\n  d.setHours(0, 0, 0, 0);\n  return d.getTime();\n}\n\nfunction presetDays(range: Exclude<RangeKey, \"custom\">): number {\n  if (range === \"12m\") return 365;\n  if (range === \"90d\") return 90;\n  if (range === \"30d\") return 30;\n  return 7;\n}\n\nexport function DashboardAnalyticsPage() {\n  const { t } = useTranslation(undefined, { keyPrefix: \"dashboard\" });\n  const [loopsModalOpen, setLoopsModalOpen] = useState(false);\n\n  // Stable \"now\" so memo calculations are deterministic (lint: react-hooks/purity)\n  const [nowMs] = useState(() => Date.now());\n\n  const [range, setRange] = useState<RangeKey>(\"7d\");\n  const [mode, setMode] = useState<ModeKey>(\"created\");\n  const [customRange, setCustomRange] = useState<CustomRange>(null);\n\n  const { loops, loopsFilter, setLoopsFilter, chartMatches } = useDashboardData();\n\n  const filteredMatches = useMemo(() => {\n    let fromMs = 0;\n    let toMs = nowMs;\n\n    if (range === \"custom\" && customRange) {\n      fromMs = clampDayStart(customRange.from.getTime());\n      toMs = clampDayStart(customRange.to.getTime()) + 24 * 60 * 60 * 1000 - 1;\n    } else {\n      const days = presetDays(range as Exclude<RangeKey, \"custom\">);\n      fromMs = nowMs - days * 24 * 60 * 60 * 1000;\n      toMs = nowMs;\n    }\n\n    return chartMatches.filter((m) => {\n      const ts =\n        mode === \"updated\"\n          ? toMillis(m.updatedAt) || toMillis(m.createdAt)\n          : toMillis(m.createdAt);\n      if (!ts) return false;\n      return ts >= fromMs && ts <= toMs;\n    });\n  }, [chartMatches, range, mode, customRange, nowMs]);\n\n  return (\n    <div className=\"flex h-full flex-col\">\n      <div className=\"shrink-0 border-b bg-background/80 backdrop-blur supports-[backdrop-filter]:bg-background/60\">\n        <div className=\"flex flex-col gap-3 px-1 pt-2 pb-4\">\n          <div className=\"flex items-center justify-between gap-3\">\n            <div className=\"text-base font-semibold text-foreground\">\n              {t(\"tabs.analytics\", \"Analytics\")}\n            </div>\n\n            <Button\n              size=\"sm\"\n              variant=\"outline\"\n              shape=\"pill\"\n              className=\"gap-2\"\n              onClick={() => setLoopsModalOpen(true)}\n            >\n              <SlidersHorizontal className=\"h-4 w-4\" />\n              {t(\"loopsFilter.button\", \"Loops\")}\n            </Button>\n          </div>\n\n          <DashboardTabsNav />\n        </div>\n      </div>\n\n      <DashboardLoopsFilterModal\n        open={loopsModalOpen}\n        onOpenChange={setLoopsModalOpen}\n        value={loopsFilter}\n        loops={loops}\n        onChange={setLoopsFilter}\n      />\n\n      <div className=\"flex-1 overflow-y-auto pb-6\">\n        <div className=\"space-y-6 p-6\">\n          <DashboardTrendsCard\n            matches={chartMatches}\n            range={range}\n            mode={mode}\n            customRange={customRange}\n            onRangeChange={setRange}\n            onModeChange={setMode}\n            onCustomRangeChange={setCustomRange}\n          />\n\n          <div className=\"grid grid-cols-1 gap-6 lg:grid-cols-2\">\n            <DashboardInsightsCard matches={filteredMatches} />\n            <DashboardStatusRadarCard matches={filteredMatches} />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default DashboardAnalyticsPage;\n"],"names":["clampDayStart","ms","d","Date","setHours","getTime","DashboardAnalyticsPage","t","useTranslation","undefined","keyPrefix","loopsModalOpen","setLoopsModalOpen","useState","nowMs","now","range","setRange","mode","setMode","customRange","setCustomRange","loops","loopsFilter","setLoopsFilter","chartMatches","useDashboardData","filteredMatches","useMemo","fromMs","toMs","from","to","days","presetDays","filter","m","ts","toMillis","updatedAt","createdAt","_jsxs","className","children","_jsx","Button","size","variant","shape","onClick","SlidersHorizontal","DashboardTabsNav","DashboardLoopsFilterModal","open","onOpenChange","value","onChange","DashboardTrendsCard","matches","onRangeChange","onModeChange","onCustomRangeChange","DashboardInsightsCard","DashboardStatusRadarCard"],"ignoreList":[],"sourceRoot":""}